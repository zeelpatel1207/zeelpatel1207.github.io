"use strict";(self.webpackChunkoculus_web=self.webpackChunkoculus_web||[]).push([[223],{1223:(oe,A,l)=>{l.r(A),l.d(A,{AdminModule:()=>xt});var m=l(6895),a=l(4719),w=l(9697),y=l(7209),d=l(7340),e=l(4650),p=l(7489),Q=l.n(p),u=l(6176),g=l(1737),h=l(4850),f=l(7221),x=l(529);const L={headers:new x.WM({"Content-Type":"application/json"})};var c=l(1338),D=l(4766);const q=D.N.baseApiUrl;let Y=(()=>{class n{constructor(t){this.http=t}getAffiliateUsers(){return this.http.get(q+c.xZ.getAffiliateProxy,{headers:L.headers}).pipe((0,h.U)(o=>o),(0,f.K)(o=>(0,g._)(o)))}assignCoupon(t){const o=q+c.xZ.assignCouponAffiliateUser.replace(":email",t.email).replace(":couponId",t.couponId);return this.http.post(o,{headers:L.headers}).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(x.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const C=D.N.baseApiUrl,b={headers:new x.WM({"Content-Type":"application/json",authorization:""})};let T=(()=>{class n{constructor(t){this.http=t}getProxyServers(){return this.http.get(C+c.xZ.getProxyServerStock,{headers:b.headers}).pipe((0,h.U)(o=>o),(0,f.K)(o=>(0,g._)(o)))}updatePlan(t){const o=C+c.xZ.updateProxyPlan.replace(":id",t.id);return this.http.put(o,t,{headers:b.headers}).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}getAllCoupon(){return this.http.get(C+c.xZ.couponList,{headers:b.headers}).pipe((0,h.U)(o=>o),(0,f.K)(o=>(0,g._)(o)))}createCoupon(t){return this.http.post(C+c.xZ.createCoupon,t,{headers:b.headers}).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}editCoupon(t){return this.http.put(C+c.xZ.editCoupon,t,{headers:b.headers}).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}deleteCoupon(t){let o=new x.LE;return t&&(o=o.set("couponId",t.toString())),this.http.delete(C+c.xZ.deleteCoupon,{headers:b.headers,params:o}).pipe((0,h.U)(s=>s),(0,f.K)(s=>(0,g._)(s)))}createToken(t){return this.http.post(C+c.xZ.createTokenWithNoPayment,t,{headers:b.headers}).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}saveProxyConfig(t){return this.http.post(C+c.xZ.saveConfig,{config:t},{headers:b.headers}).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}createResidentialToken(t){return this.http.post(C+c.xZ.createNetworkTokenWithoutPayment,t,{headers:b.headers}).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(x.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=l(1742),P=l(7185),ne=l(3056);function ie(n,r){1&n&&(e.TgZ(0,"div")(1,"div",15),e._UZ(2,"img",16),e.qZA()())}function ae(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"label",18),e._uU(2,"Coupon name"),e.qZA(),e.TgZ(3,"ng-multiselect-dropdown",19),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedItems=i)}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("placeholder","Search active coupons")("settings",t.dropdownSettings)("data",t.dropdownList)("ngModel",t.selectedItems)("disabled",t.isLoading)}}function re(n,r){1&n&&e._UZ(0,"span",20)}let se=(()=>{class n{constructor(t,o){this.osiAffiliateService=t,this.toastrService=o,this.closeModal=new e.vpe,this.dropdownList=[],this.selectedItems=[],this.dropdownSettings={singleSelection:!0,idField:"id",textField:"label",itemsShowLimit:3,maxHeight:300,allowSearchFilter:!0},this.assigningCoupon=!1,this.isLoading=!1}ngOnInit(){this.setActiveCoupon()}setActiveCoupon(){"-"!==this.selectedAffiliateUser?.coupon&&(this.selectedItems=[{id:this.selectedAffiliateUser?.couponId,label:this.selectedAffiliateUser?.coupon}])}assignCoupon(){this.selectedItems?.length?(this.assigningCoupon=!0,this.osiAffiliateService.assignCoupon({email:this.selectedAffiliateUser?.email||"",couponId:this.selectedItems?.[0]?.id||""}).subscribe(o=>{this.isLoading=!1,o&&(this.close({success:!0}),this.toastrService.success(c.xZ.successfullyAssignedCouponCodeToAffiliateUSer,c.xZ.success))},o=>{this.assigningCoupon=!1,this.toastrService.error(o,c.xZ.error)})):this.toastrService.error(c.xZ.invalidCouponCodeErrorMessage,c.xZ.error)}close(t){this.closeModal.emit(t||!0)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Y),e.Y36(P._W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-assign-coupon-osi-affiliate-user"]],inputs:{selectedAffiliateUser:"selectedAffiliateUser",dropdownList:"dropdownList"},outputs:{closeModal:"closeModal"},decls:19,vars:6,consts:[[1,"admin-layout"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-md-12","col-12"],[4,"ngIf"],["class","form-inputRow",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","oculus_btn","w-auto","btn-sm",3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["type","button",1,"btn","btn-grey","btn-sm",3,"click"],[1,"pricing-loader"],["src","assets/images/ajax-loader_1.svg"],[1,"form-inputRow"],["for","couponCodeName"],[1,"assign-affiliate-coupon",3,"placeholder","settings","data","ngModel","disabled","ngModelChange"],["role","status",1,"spinner-border","spinner-border-sm"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),e._uU(4,"Manage Coupon"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return o.close()}),e.TgZ(6,"span",5),e._uU(7,"\xd7"),e.qZA()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8),e.YNc(11,ie,3,0,"div",9),e.YNc(12,ae,4,5,"div",10),e.qZA()()(),e.TgZ(13,"div",11)(14,"button",12),e.NdJ("click",function(){return o.assignCoupon()}),e.YNc(15,re,1,0,"span",13),e._uU(16," Assign Coupon "),e.qZA(),e.TgZ(17,"button",14),e.NdJ("click",function(){return o.close()}),e._uU(18," Cancel "),e.qZA()()()()),2&t&&(e.xp6(11),e.Q6J("ngIf",o.isLoading),e.xp6(1),e.Q6J("ngIf",!o.isLoading),e.xp6(2),e.ekj("btn-disabled",o.assigningCoupon),e.Q6J("disabled",o.assigningCoupon),e.xp6(1),e.Q6J("ngIf",o.assigningCoupon))},dependencies:[m.O5,a.JJ,a.On,ne.OP],styles:["@media (min-width: 1024px){  .assign-affiliate-coupon-dialog.custom-modal{width:40%!important}}  .assign-affiliate-coupon .multiselect-dropdown .dropdown-btn{padding:8px!important}  .assign-affiliate-coupon .multiselect-dropdown .dropdown-btn span{color:#fff}  .assign-affiliate-coupon .no-filtered-data h5{font-size:1rem}.modal-body[_ngcontent-%COMP%]{height:auto;overflow:auto;min-height:275px}.modal-body[_ngcontent-%COMP%]   .form-inputRow[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:.75rem}"]}),n})();var Z=l(6907);function le(n,r){1&n&&(e.TgZ(0,"div")(1,"div",6),e._UZ(2,"img",7),e.qZA()())}const ce=function(){return[]};function de(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"app-table",8),e.NdJ("proxyList",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.assignCoupon.emit(i))}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("columns",t.columns)("data",t.affiliatedUsers||e.DdM(4,ce))("isEmptyScreenButtonDisplay",!1)("emptyScreenText","You don't have any registered affiliate users")}}function pe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"custom-modal",9)(1,"app-assign-coupon-osi-affiliate-user",10),e.NdJ("closeModal",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.closeModal(i))}),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("width","100%")("addClass","custom-modal assign-affiliate-coupon-dialog admin-coupon-dialog"),e.xp6(1),e.Q6J("dropdownList",t.dropdownList)("selectedAffiliateUser",t.selectedUser)}}let ue=(()=>{class n{constructor(t,o){this.osiAffiliateService=t,this.adminService=o,this.assignCoupon=new e.vpe,this.columns=[{index:0,key:"id",displayLabel:"Id",type:u.X.NUMBER},{index:1,key:"name",displayLabel:"Name",type:u.X.TEXT},{index:2,key:"osi_id",displayLabel:"OSI Id",type:u.X.TEXT},{index:3,key:"email",displayLabel:"Email",type:u.X.TEXT},{index:4,key:"coupon",displayLabel:"Assigned Coupon",type:u.X.TEXT},{index:5,key:"create_at",displayLabel:"Created at",type:u.X.DATE},{index:6,key:"actions",displayLabel:"",icon:"",columnWidth:60,type:u.X.ACTION,actions:[{index:1,key:"manage-coupon",title:"Manage coupon",isDivider:!0,event:this.assignCoupon,customClass:""}]}],this.mockAffiliateUser=[{id:0,name:"Harshad",osi_id:1002,email:"harshadladva123@gmail.com",create_at:new Date,coupon:"ABC"},{id:1,name:"Harshad 1",osi_id:1003,email:"harshadladva1234@gmail.com",create_at:new Date,coupon:"ABC"}],this.coupons=[],this.selectedUser=null,this.affiliatedUsers=[],this.isLoading=!1,this.dropdownList=[]}ngOnInit(){this.getAllCoupon(),this.getTableActionEvents()}getTableActionEvents(){this.assignedCouponSubscription=this.assignCoupon.subscribe(t=>{t&&(this.selectedUser=t)})}getAllCoupon(){this.dropdownList=[],this.isLoading=!0,this.adminService.getAllCoupon().subscribe(t=>{(0,p.forEach)(t,(o,i)=>{o.isExpired||this.dropdownList.push({id:o?.id,label:o?.couponCodeName})}),this.getAffiliateUsers()},t=>{this.isLoading=!1})}getAffiliateUsers(){this.affiliatedUsers=[],this.osiAffiliateService.getAffiliateUsers().subscribe(t=>{this.isLoading=!1,t.length&&(0,p.forEach)(t,(o,i)=>{this.affiliatedUsers.push({id:`${i+1}`,name:o?.firstName+" "+o?.lastName,osi_id:o?.osiId,email:o?.userName,create_at:o?.createdDate||null,coupon:this.getCouponName(o),couponId:o?.couponId||""})})},()=>{this.isLoading=!1})}getCouponName(t){return this.dropdownList.find(o=>+o.id==+t?.couponId)?.label||"-"}closeModal(t){console.log("data",t),t?.success&&this.getAllCoupon(),this.selectedUser=null}ngOnDestroy(){this.affiliatedUsers=[],this.selectedUser=null,this.assignedCouponSubscription&&this.assignedCouponSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Y),e.Y36(T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-osi-affiliate"]],decls:8,vars:4,consts:[[1,"admin-layout","layout","mt-5"],[1,"osi-affiliate-section","contentPart"],[1,"container"],[1,"osi-affiliate-user"],[4,"ngIf"],["id","osi-affiliate",3,"width","addClass",4,"ngIf"],[1,"pricing-loader"],["src","assets/images/ajax-loader_1.svg"],["proxyListLabel","Manage coupon",3,"columns","data","isEmptyScreenButtonDisplay","emptyScreenText","proxyList"],["id","osi-affiliate",3,"width","addClass"],[3,"dropdownList","selectedAffiliateUser","closeModal"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4,"OSI Affiliate Users"),e.qZA(),e.YNc(5,le,3,0,"div",4),e.YNc(6,de,2,5,"div",4),e.qZA()()(),e.YNc(7,pe,2,4,"custom-modal",5)),2&t&&(e.Q6J("@fade",void 0),e.xp6(5),e.Q6J("ngIf",o.isLoading),e.xp6(1),e.Q6J("ngIf",!o.isLoading),e.xp6(1),e.Q6J("ngIf",o.selectedUser))},dependencies:[m.O5,S.a,se,Z.R],styles:[".container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:2rem;text-align:center}"],data:{animation:[(0,d.X$)("fade",[(0,d.eR)("void => *",[(0,d.oB)({opacity:0}),(0,d.jt)(700,(0,d.oB)({opacity:1}))])])]}}),n})();var z=l(2198),k=l(1507),me=l(8085),V=l(8929);let B=(()=>{class n{constructor(){this.status=new V.xQ,this._active=!1,this.isLoading=new V.xQ}get active(){return this._active}set active(t){this._active=t,this.status.next(t)}show(){this.active=!0}hide(){this.active=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ge(n,r){1&n&&e._UZ(0,"span",9)}let he=(()=>{class n{constructor(t,o,i,s){this.orderBy=t,this.adminService=o,this.customModalService=i,this.loadingService=s,this.selectedCoupon={},this.coupons={},this.closeDeletePopup=new e.vpe,this.loader=!1}ngOnInit(){console.log("this.selectedcoupon",this.selectedCoupon,this.coupons)}deleteCoupon(){let t=this.selectedCoupon?.id;this.loader=!0,this.adminService.deleteCoupon(t).subscribe(o=>{this.loader=!1,console.log(o);let i=Q().findIndex(t,{id:t});this.coupons.splice(i,1),this.closeModel("submit")},o=>{this.loader=!1,console.log(o)})}closeModel(t="close"){this.closeDeletePopup.emit({type:t}),this.customModalService.close("coupon-delete-dialog")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(me.d),e.Y36(T),e.Y36(k.k),e.Y36(B))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-coupon-delete"]],inputs:{selectedCoupon:"selectedCoupon",coupons:"coupons"},outputs:{closeDeletePopup:"closeDeletePopup"},decls:15,vars:4,consts:[[1,"modal-header","bgColor"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","bgColor"],[1,"modal-footer","bgColor"],["type","button",1,"btn","oculus_btn","btn-sm",3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["type","button",1,"btn","btn-grey","bg-white","btn-sm",3,"click"],["role","status",1,"spinner-border","spinner-border-sm"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h5",1),e._uU(2,"Delete Warning!"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return o.closeModel("close")}),e.TgZ(4,"span",3),e._uU(5,"x"),e.qZA()()(),e.TgZ(6,"div",4)(7,"span"),e._uU(8," No user will be able to access this coupon after delete. Are you sure to delete it ? "),e.qZA()(),e.TgZ(9,"div",5)(10,"button",6),e.NdJ("click",function(){return o.deleteCoupon()}),e.YNc(11,ge,1,0,"span",7),e._uU(12," Delete "),e.qZA(),e.TgZ(13,"button",8),e.NdJ("click",function(){return o.closeModel("close")}),e._uU(14," Cancel "),e.qZA()()),2&t&&(e.xp6(10),e.ekj("btn-disabled",o.loader),e.Q6J("disabled",o.loader),e.xp6(1),e.Q6J("ngIf",o.loader))},dependencies:[m.O5],styles:["@media (min-width: 1024px){.custom-modal{width:35%!important}}.bgColor{background-color:#2e3342}.bg-white{background-color:#9d9d9d}.btn-disabled{background:#9d9d9d!important;cursor:auto!important}\n"],encapsulation:2}),n})();var fe=l(5439);const U=n=>n&&n.length?n.map(r=>r.replaceAll(/(\r\n|\n|\r| )/gm,"")):[],_e=n=>n?n.replaceAll(/(%|\r\n|\n|\r| )/gm,""):"";var X=l(4628);function Ce(n,r){1&n&&(e.TgZ(0,"div")(1,"p",29),e._uU(2,"Discount percentage must be below 100"),e.qZA()())}function be(n,r){1&n&&e._UZ(0,"span",32)}function ye(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveCoupon())}),e.YNc(1,be,1,0,"span",31),e._uU(2," Create "),e.qZA()}if(2&n){const t=e.oxw();e.ekj("btn-disabled",t.loader),e.Q6J("disabled",t.loader),e.xp6(1),e.Q6J("ngIf",t.loader)}}function ve(n,r){1&n&&e._UZ(0,"span",32)}function xe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editCoupon())}),e.YNc(1,ve,1,0,"span",31),e._uU(2," Edit "),e.qZA()}if(2&n){const t=e.oxw();e.ekj("btn-disabled",t.loader),e.Q6J("disabled",t.loader),e.xp6(1),e.Q6J("ngIf",t.loader)}}const Pe=function(){return["fa fa-angle-right"]},ke=function(){return["fa fa-angle-left"]},Te=function(){return{standalone:!0}};let E=fe,Me=(()=>{class n{constructor(t,o,i,s,v,R){this.fb=t,this.toastr=o,this.adminService=i,this._elementRef=s,this.customModalService=v,this.changeDetectRef=R,this.selectedCoupon={},this.isSaveCoupon=!0,this.closeSaveEditPopUp=new e.vpe,this.couponForm=new a.nJ({}),this._isPickerOpen=!1,this.disablePastDates=!0,this.percentage=!1,this.value=100,this.discountPattern="^[0-9]{1,2}?$",this.loader=!1,this.dateInputFilter=O=>!this.disablePastDates||O&&O>=E().valueOf(),this.datePickerFilter=(O,Pt)=>!this.disablePastDates||O.value>=E().startOf(Pt).valueOf()}ngOnInit(){console.log("this.selectedCoupon",this.selectedCoupon),this.selectedCoupon.validTill&&(this.selectedCoupon.validTill=new Date(this.selectedCoupon.validTill)),this.couponForm=this.fb.group({couponCodeName:new a.p4(this.selectedCoupon.couponCodeName,[a.kI.required]),discountPercentage:new a.p4(+_e(this.selectedCoupon.discountPercentage),[a.kI.required,a.kI.pattern(this.discountPattern)]),validTill:new a.p4(new Date,[a.kI.required]),quantityAvailable:new a.p4(+this.getAvailableQuantity(this.selectedCoupon.quantityUsedAndAvailable),[a.kI.required])})}ngAfterViewInit(){const t=$('[data-toggle="dropdown"]',this._elementRef.nativeElement);t.parent().on("show.bs.dropdown",()=>{this._isPickerOpen=!0}),t.parent().on("hide.bs.dropdown",()=>{this._isPickerOpen=!1}),this.changeDetectRef.detectChanges()}getAvailableQuantity(t){return t?t.split("/").length?t.split("/")[1]:0:""}get couponFormControls(){return this.couponForm.controls}dateSelected(t){this.couponFormControls.validTill.patchValue(t.value),this._isPickerOpen&&t.value&&$(".date-dropdown").dropdown("toggle")}keepDropDownOpen(t){t.stopPropagation()}saveCoupon(){let t=this.couponData();t&&(this.loader=!0,this.adminService.createCoupon(t).subscribe(o=>{this.loader=!1,console.log(o),this.toastr.success("Coupon is created successfully","Success"),this.closeModel("submit")},o=>{this.loader=!1,console.log(o)}))}editCoupon(){let t=this.couponData();t&&(this.loader=!0,this.adminService.editCoupon(t).subscribe(o=>{this.loader=!1,console.log(o),this.closeModel("submit")},o=>{this.loader=!1,console.log(o)}))}discountKeyPress(t){return!(t.target.value.length>1)}couponData(){if(!this.couponForm.valid)return this.toastr.error("Please enter valid coupon details","Validation Error!",{closeButton:!0}),null;let t=this.selectedCoupon;return t.couponCodeName=this.couponFormControls.couponCodeName.value,t.discountPercentage=this.couponFormControls.discountPercentage.value,t.quantityAvailable=this.couponFormControls.quantityAvailable.value,t.validTill=E(this.couponFormControls.validTill.value).toISOString(),t}closeModel(t){this.resetForm(),this.closeSaveEditPopUp.emit(t),this.customModalService.close("coupon-dialog")}resetForm(){this.selectedCoupon={},this.couponForm.reset()}ngOnDestroy(){this.resetForm()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(a.QS),e.Y36(P._W),e.Y36(T),e.Y36(e.SBq),e.Y36(k.k),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-coupon-dialog"]],inputs:{selectedCoupon:"selectedCoupon",isSaveCoupon:"isSaveCoupon"},outputs:{closeSaveEditPopUp:"closeSaveEditPopUp"},decls:43,vars:14,consts:[[1,"admin-layout"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-md-12","col-12"],[1,"form-inputRow"],["for","couponCodeName"],["type","text","id","couponCodeName","name","couponCodeName","placeholder","Coupon name","formControlName","couponCodeName",1,"form-input-control",3,"readonly"],["for","discountPercentage"],["type","number","id","discountPercentage","name","discountPercentage","placeholder","Discount (%)","min","0","max","99","formControlName","discountPercentage",1,"form-input-control",3,"keypress"],[4,"ngIf"],["for","validTill"],["type","datetime","name","validTill","id","validTill","placeholder","Valid till","formControlName","validTill","dlDateTimeInput","","readonly","",1,"form-input-control",3,"dlDateTimeInputFilter"],[1,"input-group-append","date-time-dropdown"],["type","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","border","fontsize","dropdown-toggle","date-dropdown"],[1,"oi","oi-calendar"],[1,"dropdown-menu",3,"click"],[2,"width","360px"],["ngDefaultControl","",3,"selectFilter","ngModel","rightIconClass","leftIconClass","ngModelOptions","ngModelChange","change"],["for","quantityAvailable"],["type","number","id","quantityAvailable","name","quantityAvailable","placeholder","Quantity Available","formControlName","quantityAvailable",1,"form-input-control"],[1,"modal-footer"],["type","button","class","btn oculus_btn btn-sm",3,"disabled","btn-disabled","click",4,"ngIf"],["type","button",1,"btn","btn-grey","btn-sm",3,"click"],[1,"red"],["type","button",1,"btn","oculus_btn","btn-sm",3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),e._uU(4,"Manage Coupon"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return o.closeModel("close")}),e.TgZ(6,"span",5),e._uU(7,"\xd7"),e.qZA()()(),e.TgZ(8,"div",6)(9,"form",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),e._uU(14,"Coupon name"),e.qZA(),e._UZ(15,"input",12),e.qZA()(),e.TgZ(16,"div",9)(17,"div",10)(18,"label",13),e._uU(19,"Discount (%)"),e.qZA(),e.TgZ(20,"input",14),e.NdJ("keypress",function(s){return o.discountKeyPress(s)}),e.qZA(),e.YNc(21,Ce,3,0,"div",15),e.qZA()(),e.TgZ(22,"div",9)(23,"div",10)(24,"label",16),e._uU(25,"Valid Till"),e.qZA(),e._UZ(26,"input",17),e.TgZ(27,"div",18)(28,"button",19),e._UZ(29,"i",20),e.qZA(),e.TgZ(30,"div",21),e.NdJ("click",function(s){return o.keepDropDownOpen(s)}),e.TgZ(31,"div",22)(32,"dl-date-time-picker",23),e.NdJ("ngModelChange",function(s){return o.selectedCoupon.validTill=s})("change",function(s){return o.dateSelected(s)}),e.qZA()()()()()(),e.TgZ(33,"div",9)(34,"div",10)(35,"label",24),e._uU(36,"Quantity Available"),e.qZA(),e._UZ(37,"input",25),e.qZA()()()()(),e.TgZ(38,"div",26),e.YNc(39,ye,3,4,"button",27),e.YNc(40,xe,3,4,"button",27),e.TgZ(41,"button",28),e.NdJ("click",function(){return o.closeModel("close")}),e._uU(42," Cancel "),e.qZA()()()()),2&t&&(e.xp6(9),e.Q6J("formGroup",o.couponForm),e.xp6(6),e.Q6J("readonly",!o.isSaveCoupon),e.xp6(6),e.Q6J("ngIf",o.couponForm.controls.discountPercentage.touched&&o.couponForm.controls.discountPercentage.errors),e.xp6(5),e.Q6J("dlDateTimeInputFilter",o.dateInputFilter),e.xp6(6),e.Q6J("selectFilter",o.datePickerFilter)("ngModel",o.selectedCoupon.validTill)("rightIconClass",e.DdM(11,Pe))("leftIconClass",e.DdM(12,ke))("ngModelOptions",e.DdM(13,Te)),e.xp6(7),e.Q6J("ngIf",o.isSaveCoupon),e.xp6(1),e.Q6J("ngIf",!o.isSaveCoupon))},dependencies:[m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.qQ,a.Fd,a.On,a.sg,a.u,X.Kn,X._9],styles:["@media (min-width: 1024px){.custom-modal{width:40%!important}}.input-group-append .date-dropdown{box-shadow:none}.date-time-dropdown .dropdown-menu{background:#d8dade}.date-dropdown:after{content:icon}.red{color:red}.btn-grey{background-color:#cac4c4!important}.btn-disabled{background:#9d9d9d!important;cursor:auto!important}\n"],encapsulation:2}),n})();function Oe(n,r){1&n&&(e.TgZ(0,"div",4)(1,"div",16)(2,"div",17),e._UZ(3,"img",18),e.qZA()()())}function Ae(n,r){1&n&&(e.TgZ(0,"div",19)(1,"div",7)(2,"div",20)(3,"p"),e._uU(4,"No active coupons found."),e.qZA()()()())}function we(n,r){1&n&&(e.TgZ(0,"div",26),e._UZ(1,"div",7),e.qZA())}const Se=function(){return["asc","desc"]},Ze=function(){return["status","createdOn"]};function De(n,r){if(1&n&&(e.TgZ(0,"div",19)(1,"div",7)(2,"div",21)(3,"div",22)(4,"div",23),e.YNc(5,we,2,0,"div",24),e._UZ(6,"app-table",25),e.qZA()()()()()),2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngIf",t.isNoCoupons),e.xp6(1),e.Q6J("columns",t.columns)("data",t.coupons)("orderDirection",e.DdM(5,Se))("orderKey",e.DdM(6,Ze))}}function Ue(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"custom-modal",27),e.NdJ("onClose",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.closeCouponPopup(i))}),e.TgZ(1,"app-coupon-dialog",28),e.NdJ("closeSaveEditPopUp",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.closeSaveAndEditPopup(i))}),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("width","100%")("addClass","custom-modal admin-coupon-dialog"),e.xp6(1),e.Q6J("selectedCoupon",t.selectedCoupon)("isSaveCoupon",t.isSaveCoupon)}}function Ee(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"custom-modal",29),e.NdJ("onClose",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.closeCouponPopup(i))}),e.TgZ(1,"app-coupon-delete",30),e.NdJ("closeDeletePopup",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.closeDeletePopUp(i))}),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("width","100%")("addClass","custom-modal admin-coupon-dialog"),e.xp6(1),e.Q6J("coupons",t.coupons)("selectedCoupon",t.selectedCoupon)}}let Ie=(()=>{class n{constructor(t,o){this.adminService=t,this.customModalService=o,this.deleteModel=!1,this.show=!1,this.coupons=[],this.selectedCoupon={},this.isNoCoupons=!0,this.isSaveCoupon=!0,this.openCouponDialog=!1,this.openCouponDeleteDialog=!1,this.editIcon=new e.vpe,this.deleteIcon=new e.vpe,this.isLoading=!0,this.columns=[{index:0,key:"orderIndex",displayLabel:"COUPON #",type:u.X.NUMBER},{index:1,key:"couponCodeName",displayLabel:"CODE NAME",type:u.X.TEXT},{index:2,key:"discountPercentage",displayLabel:"DISCOUNT(%)",type:u.X.TEXT},{index:3,key:"validTill",displayLabel:"VALID TILL",type:u.X.DATE},{index:4,key:"quantityUsedAndAvailable",displayLabel:"QUANTITY",type:u.X.TEXT},{index:5,key:"status",displayLabel:"STATUS",type:u.X.STATUS},{index:6,key:"createdOn",displayLabel:"CREATED ON",type:u.X.DATE},{index:7,key:"actions",isDisplayWithoutIcon:!0,displayLabel:"",icon:"",type:u.X.ACTION,actions:[{index:0,icon:"fas fa-edit mr-3 cursor-pointer",event:this.editIcon},{index:1,icon:"fas fa-trash-alt cursor-pointer",event:this.deleteIcon}]}]}ngOnInit(){this.getAllCoupon(),this.getEventEmitterFromTable()}getEventEmitterFromTable(){this.editIcon.pipe((0,z.h)(t=>!!t)).subscribe(t=>{this.openEditManageDialog(t)}),this.deleteIcon.pipe((0,z.h)(t=>!!t)).subscribe(t=>{this.confirmDelete(t)})}getAllCoupon(){this.isLoading=!0,this.adminService.getAllCoupon().subscribe(t=>{console.log(t),this.isLoading=!1,this.isNoCoupons=!(!t||0==t.length),this.coupons=[],t.forEach((o,i)=>{this.coupons.push({orderIndex:`${i+1}`,couponCodeName:o.couponCodeName,discountPercentage:`${o.discountPercentage}%`,validTill:o.validTill,quantityUsedAndAvailable:`${o.quantityUsed} / ${o.quantityAvailable}`,status:this.findStatus(o),createdOn:o.createdOn,id:o.id})})},t=>{this.isLoading=!1})}findStatus(t){return 1==t.isActive?t.isExpired||t?.quantityUsed>=t?.quantityAvailable?"expired":"active":"inactive"}openCreateManageDialog(){this.openCouponDialog=!0,this.isSaveCoupon=!0,this.selectedCoupon={},this.customModalService.open("coupon-dialog")}openEditManageDialog(t){console.log(t),this.openCouponDialog=!0,this.isSaveCoupon=!1,this.selectedCoupon=t,this.customModalService.open("coupon-dialog")}confirmDelete(t){this.openCouponDeleteDialog=!0,this.selectedCoupon=t,this.customModalService.open("coupon-delete-dialog")}closeCouponPopup(t){this.selectedCoupon={},this.openCouponDialog=!1,this.openCouponDeleteDialog=!1}closeSaveAndEditPopup(t){"submit"===t&&this.getAllCoupon()}closeDeletePopUp(t){"submit"===t?.type&&this.getAllCoupon()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T),e.Y36(k.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-manage-coupon"]],decls:20,vars:6,consts:[[1,"layout","mt-5"],[1,"container","res"],[1,"terms-conditions-section","contentPart"],[1,"container-fluid","d-table"],[1,"row"],[1,"col-12","col-12-sm"],[1,"my-orders-part"],[1,"col-12"],[1,"d-flex"],[1,"font-weight-normal"],[1,"d-flex","flex-column","full-width","text-right","align-items-end","m-4"],[1,"text-green","text-bold","create-coupon-button",2,"cursor","pointer",3,"click"],["class","row",4,"ngIf"],["class","row mt-4",4,"ngIf"],["id","coupon-dialog",3,"width","addClass","onClose",4,"ngIf"],["id","coupon-delete-dialog",3,"width","addClass","onClose",4,"ngIf"],[1,"col-12","d-flex","justify-content-center"],[1,"pricing-loader"],["src","assets/images/ajax-loader_1.svg"],[1,"row","mt-4"],[1,"my-orders-withoutPlan-content"],[1,"my-orders-Plantable-content"],[1,"my-orders-table"],[1,"my-orders-table-responsive"],["class","row create-coupon",4,"ngIf"],[3,"columns","data","orderDirection","orderKey"],[1,"row","create-coupon"],["id","coupon-dialog",3,"width","addClass","onClose"],[3,"selectedCoupon","isSaveCoupon","closeSaveEditPopUp"],["id","coupon-delete-dialog",3,"width","addClass","onClose"],[3,"coupons","selectedCoupon","closeDeletePopup"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",4)(8,"div",7)(9,"div",8)(10,"h1",9),e._uU(11,"Coupons"),e.qZA(),e.TgZ(12,"div",10)(13,"a",11),e.NdJ("click",function(){return o.openCreateManageDialog()}),e._uU(14,"Create Coupon"),e.qZA()()()()(),e.YNc(15,Oe,4,0,"div",12),e.YNc(16,Ae,5,0,"div",13),e.YNc(17,De,7,7,"div",13),e.qZA()()()()()()(),e.YNc(18,Ue,2,4,"custom-modal",14),e.YNc(19,Ee,2,4,"custom-modal",15)),2&t&&(e.Q6J("@fade",void 0),e.xp6(15),e.Q6J("ngIf",o.isLoading),e.xp6(1),e.Q6J("ngIf",!o.isNoCoupons&&!o.isLoading),e.xp6(1),e.Q6J("ngIf",o.isNoCoupons&&!o.isLoading&&0!=o.coupons.length),e.xp6(1),e.Q6J("ngIf",o.openCouponDialog),e.xp6(1),e.Q6J("ngIf",o.openCouponDeleteDialog))},dependencies:[m.O5,S.a,he,Me,Z.R],styles:['.layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]{margin:5% 40%}.layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .top-bar[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .top-bar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:26px;color:#fff;line-height:normal;text-align:center;text-transform:capitalize}.layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .top-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:60px;border-style:solid;border-width:2px;border-image-source:linear-gradient(265deg,#0091a7,#ccff90);border-image-slice:1;display:block;margin:14px auto 0}.layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{background:white;padding:30px 10px}.layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .lable-color[_ngcontent-%COMP%]{padding:5px 0;color:#000}.layout[_ngcontent-%COMP%]   .btn-disabled[_ngcontent-%COMP%]{background:#9d9d9d!important;cursor:auto!important}.layout[_ngcontent-%COMP%]   .register-content[_ngcontent-%COMP%]{max-width:380px;margin:4% 0;border-radius:5px;background-color:#fff;box-shadow:0 2px 4px #00000080;color:#000}.layout[_ngcontent-%COMP%]   .register-form[_ngcontent-%COMP%]{padding:2.5rem 2.625rem}@media only screen and (min-width: 992px){.layout[_ngcontent-%COMP%]   register-form[_ngcontent-%COMP%]{padding:40px 42px}}.layout   [_nghost-%COMP%]     .form-inputRow{margin-bottom:20px}.layout   [_nghost-%COMP%]     .form-inputRow .country-code .country-code-picker{padding:0!important}.layout   [_nghost-%COMP%]     .form-inputRow .country-code .form-control{font-family:Circular!important;font-size:14px;font-weight:500;line-height:normal;width:100%;border-radius:3px;outline:none;height:48px;background-color:#f8fafd!important;border:solid 1px #cbd3df!important}.layout[_ngcontent-%COMP%]   .register-input-control[_ngcontent-%COMP%]{font-family:roboto;font-size:14px;font-weight:500;line-height:normal;color:#002c60;width:100%;border-radius:3px;outline:none;background-color:#f8fafd;border:solid 1px #add8e6;padding:16px 10px 15px 20px}.layout[_ngcontent-%COMP%]   .register-input-control.error-msg[_ngcontent-%COMP%]{border-color:#ff0004}.layout[_ngcontent-%COMP%]   .register-input-control[_ngcontent-%COMP%]::placeholder{color:#999}.layout[_ngcontent-%COMP%]   .submit_btn[_ngcontent-%COMP%]{font-family:roboto;font-size:14px;font-weight:500;line-height:45px;height:45px;color:#fff;width:100%;border-radius:3px;border:none;outline:none;cursor:pointer;background-image:linear-gradient(to right,#0099a5,#41b787);box-shadow:0 2px 3px #75757580;transition:all .2s ease-in-out}.layout[_ngcontent-%COMP%]   .submit_btn[_ngcontent-%COMP%]:hover{background-image:linear-gradient(to right,#41b787,#41b787)}.layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]{border-top:1px solid #dbe2ec;padding:22px 0 40px}.layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#757575;line-height:normal;text-align:center}.layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;color:#002c60}.layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#41b787}.layout[_ngcontent-%COMP%]   .g-recaptcha-response[_ngcontent-%COMP%]{width:250px;height:40px;border:1px solid rgb(193,193,193);margin:10px 25px;padding:0;resize:none;display:none}.layout[_ngcontent-%COMP%]   .otp_textbox[_ngcontent-%COMP%]{width:45px;height:50px;padding:12px 4px 16px;margin:5px;font-size:45px;font-weight:700;text-indent:5px;color:#002c60;border-radius:3px;outline:none;background-color:#f8fafd;border:solid 1px #cbd3df}.layout[_ngcontent-%COMP%]   .form-inputRow[_ngcontent-%COMP%]{margin-bottom:20px}.layout[_ngcontent-%COMP%]   .otp_title[_ngcontent-%COMP%]{margin-bottom:20px;display:block;font-weight:"500"}.layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:roboto,sans-serif;-webkit-appearance:none}.layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   .ng-invalid[_ngcontent-%COMP%]{border-color:#ff0004}.layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   .ng-valid[_ngcontent-%COMP%]{border-color:#90ee90}.layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   .ng-untouched[_ngcontent-%COMP%]{border-color:#add8e6}.layout[_ngcontent-%COMP%]   #partitioned[_ngcontent-%COMP%]{padding-left:15px;letter-spacing:42px;border:0;background-image:linear-gradient(to left,black 70%,rgba(255,255,255,0) 0%);background-position:bottom;background-size:50px 1px;background-repeat:repeat-x;background-position-x:35px;width:220px;min-width:220px}.layout[_ngcontent-%COMP%]   #lblTermCondition[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:#757576;margin:0 5px;cursor:pointer}.layout[_ngcontent-%COMP%]   .panel_dark[_ngcontent-%COMP%]{padding:50px;border-radius:5px;background-color:#2e3342;border:1px solid rgb(65,71,90);color:#bbb;box-shadow:0 0 40px #0006}.layout[_ngcontent-%COMP%]   .panel_dark[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:3px;background-color:#171b25;background-clip:padding-box;border:1px solid #4b5167;color:#bbb}.layout[_ngcontent-%COMP%]   .oculus_btn[_ngcontent-%COMP%]{font-weight:500;color:#fff;line-height:37px;height:37px;width:100px;display:block;text-align:center;border-radius:3px;background-image:linear-gradient(to right,#0099a5,#41b787);box-shadow:0 2px 3px #75757580;transition:all .7s ease-in-out}.layout[_ngcontent-%COMP%]   .oculus_btn.disableBtn[_ngcontent-%COMP%]{background-color:#b3e4d0;background-image:none;box-shadow:none;cursor:not-allowed;pointer-events:none}.layout[_ngcontent-%COMP%]   .oculus_btn[_ngcontent-%COMP%]:hover{color:#fff;background-image:linear-gradient(to right,#41b787,#41b787)}.layout[_ngcontent-%COMP%]   .text-color[_ngcontent-%COMP%]{color:#a9adbb}.layout[_ngcontent-%COMP%]   .res[_ngcontent-%COMP%]{overflow:auto}.layout[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%]{cursor:pointer}.layout[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#a9adbb}.layout[_ngcontent-%COMP%]   .text-green[_ngcontent-%COMP%]{color:#41b787}.layout[_ngcontent-%COMP%]   .border-none[_ngcontent-%COMP%]{border-top:1px solid #495057!important}.layout[_ngcontent-%COMP%]   .border-color[_ngcontent-%COMP%]{border-bottom:1px solid #495057!important}  .admin-coupon-dialog .custom-modal .custom-modal-body{overflow:auto!important}'],data:{animation:[(0,d.X$)("fade",[(0,d.eR)("void => *",[(0,d.oB)({opacity:0}),(0,d.jt)(700,(0,d.oB)({opacity:1}))])])]}}),n})();const j=n=>{n.hide()},I=D.N.baseApiUrl,N={headers:new x.WM({"Content-Type":"application/json"})};let K=(()=>{class n{constructor(t,o,i){this.http=t,this.toastrService=o,this.router=i}createISPToken(t){return this.http.post(I+c.xZ.createToken,t,N).pipe((0,h.U)(i=>i),(0,f.K)(i=>(0,g._)(i)))}getAllProxies(){return this.http.get(I+c.xZ.getAllIspProxy,{headers:N.headers}).pipe((0,h.U)(o=>o),(0,f.K)(o=>(0,g._)(o)))}getProxyServerStock(){return this.http.get(I+c.xZ.getIspProxyServerStock,{headers:N.headers}).pipe((0,h.U)(o=>o),(0,f.K)(o=>(0,g._)(o)))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(x.eN),e.LFG(P._W),e.LFG(w.F0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Je(n,r){if(1&n&&(e.TgZ(0,"option",16),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",null==t||null==t.proxyLocation?null:t.proxyLocation.locationDisplayName," ")}}function Re(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Je,2,2,"option",15),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.regions)}}function Qe(n,r){if(1&n&&(e.TgZ(0,"option",16),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",null==t?null:t.proxyDurationLabel," ")}}function Le(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Qe,2,2,"option",15),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.durations)}}function qe(n,r){1&n&&e._UZ(0,"span",17)}let Ye=(()=>{class n{constructor(t,o,i,s,v){this.tokenAllocationService=t,this.adminService=o,this.fb=i,this.toastr=s,this.loadingService=v,this.planForm=new a.nJ({}),this.regions=[],this.durations=[],this.loader=!1,(n=>{this.loadingService.show()})()}ngOnInit(){this.planForm=this.fb.group({region:new a.p4(this.selectedRegion,[a.kI.required]),duration:new a.p4(this.selectedDuration,[a.kI.required]),supportedSite:new a.p4(this.supportedSite,[a.kI.required])}),this.getAllProxy()}get planFormControls(){return this.planForm.controls}getAllProxy(){this.tokenAllocationService.getAllProxies().subscribe(t=>{this.allProxies=t,p.forEach(t,o=>{p.find(this.regions,{proxyLocation:{locationName:o.proxyLocation.locationName}})||this.regions.push(o)}),this.selectedRegion=this.regions[0],this.planFormControls.region.patchValue(this.selectedRegion),this.fillDuration(this.selectedRegion.proxyLocation.locationName),this.changeDuration(),j(this.loadingService)},t=>{j(this.loadingService)})}fillDuration(t){this.durations=[],p.forEach(this.allProxies,o=>{o.proxyLocation.locationName==t&&!p.find(this.durations,{proxyDurationLabel:o.proxyDurationLabel})&&this.durations.push(o)}),this.durations=p.sortBy(this.durations,o=>o.proxyDurationHrs),this.selectedDuration=this.durations[0],this.planFormControls.duration.patchValue(this.selectedDuration),this.changeDuration(),this.planFormControls.supportedSite.patchValue(this.supportedSite)}changeRegion(){this.selectedRegion=this.planFormControls.region.value,this.fillDuration(this.selectedRegion.proxyLocation.locationName)}changeDuration(){if(this.selectedDuration=this.planFormControls.duration.value,this.selectedDuration.supportedSites){var t=this.selectedDuration.supportedSites.replace("<br/>","\n");this.supportedSite=t}else this.supportedSite=null;this.planFormControls.supportedSite.patchValue(this.supportedSite)}updatePlanDetails(){if(this.loader=!0,this.planForm.valid){var t=this.planFormControls.duration.value;t.supportedSites=this.planFormControls.supportedSite.value,this.adminService.updatePlan(t).subscribe(o=>{this.loader=!1,this.toastr.success("Proxy plan is updated successfully","Success",{closeButton:!0})},o=>{})}else this.loader=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(K),e.Y36(T),e.Y36(a.QS),e.Y36(P._W),e.Y36(B))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-manage-plan"]],decls:26,vars:8,consts:[[1,"layout","mt-5"],[1,"terms-conditions-section","contentPart"],[1,"container"],[1,"font-weight-normal"],[1,"card","p-4",3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-4"],["for","inputState"],["id","inputState","formControlName","region",1,"form-control",3,"change"],[4,"ngIf"],["id","inputState","formControlName","duration",1,"form-control",3,"change"],["type","text","rows","3","cols","6","placeholder","Enter Sites details","formControlName","supportedSite",1,"form-control"],[1,"text-right","d-flex","flex-row-reverse"],[1,"oculus_btn","border",3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["role","status",1,"spinner-border","spinner-border-sm"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4,"Edit plan content"),e.qZA(),e._UZ(5,"hr"),e.TgZ(6,"form",4)(7,"div",5)(8,"div",6)(9,"label",7),e._uU(10,"Choose Region"),e.qZA(),e.TgZ(11,"select",8),e.NdJ("change",function(){return o.changeRegion()}),e.YNc(12,Re,2,1,"ng-container",9),e.qZA()(),e.TgZ(13,"div",6)(14,"label",7),e._uU(15,"Choose Proxy Duration"),e.qZA(),e.TgZ(16,"select",10),e.NdJ("change",function(){return o.changeDuration()}),e.YNc(17,Le,2,1,"ng-container",9),e.qZA()(),e.TgZ(18,"div",6)(19,"label",7),e._uU(20,"Enter Supported Sites"),e.qZA(),e._UZ(21,"textarea",11),e.qZA()(),e.TgZ(22,"div",12)(23,"button",13),e.NdJ("click",function(){return o.updatePlanDetails()}),e.YNc(24,qe,1,0,"span",14),e._uU(25," Save "),e.qZA()()()()()()),2&t&&(e.Q6J("@fade",void 0),e.xp6(6),e.Q6J("formGroup",o.planForm),e.xp6(6),e.Q6J("ngIf",o.regions),e.xp6(5),e.Q6J("ngIf",o.durations),e.xp6(6),e.ekj("btn-disabled",o.loader),e.Q6J("disabled",o.loader),e.xp6(1),e.Q6J("ngIf",o.loader))},dependencies:[m.sg,m.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u],styles:[".panel_dark[_ngcontent-%COMP%]{padding:50px;border-radius:5px;background-color:#2e3342;border:1px solid rgb(65,71,90);color:#bbb;box-shadow:0 0 40px #0006}.form-control[_ngcontent-%COMP%]{border-radius:3px!important;background-color:#171b25!important;background-clip:padding-box!important;border:1px solid #4b5167!important;color:#bbb!important}.border[_ngcontent-%COMP%]{border:none!important}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#41b787!important;transition:all 0s}.card[_ngcontent-%COMP%]{background:#222633}.btn-disabled[_ngcontent-%COMP%]{background:#9d9d9d!important;cursor:auto!important}"],data:{animation:[(0,d.X$)("fade",[(0,d.eR)("void => *",[(0,d.oB)({opacity:0}),(0,d.jt)(700,(0,d.oB)({opacity:1}))])])]}}),n})();var G=l(4608),_=(()=>{return(n=_||(_={})).DEFAULT="default",n.CUSTOM="custom",_;var n})(),H=l(8225),ze=l(6349),F=l(1179),J=l(5628);let W=(()=>{class n{constructor(t){this.customModalService=t,this.residentialOrderSummary=[],this.columns=[{index:0,key:"orderIndex",displayLabel:"#",type:u.X.NUMBER},{index:1,key:"email",displayLabel:"EMAIL",type:u.X.TEXT},{index:2,key:"message",displayLabel:"STATUS",type:u.X.TEXT}]}ngOnInit(){}closeModel(){this.customModalService.close("token-summary")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(k.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-res-token-summary"]],inputs:{residentialOrderSummary:"residentialOrderSummary"},decls:12,vars:2,consts:[[2,"padding-right","10px","display","block"],[1,"modal-dialog","modal-lg","upgrade-modal",2,"background","#2e3342"],[1,"modal-content",2,"background","#2e3342"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"container"],[3,"columns","data"],[1,"modal-footer"],["type","button",1,"oculus_btn","border",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),e._uU(5,"Create Token Summary"),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6),e._UZ(8,"app-table",7),e.qZA()(),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){return o.closeModel()}),e._uU(11," Close "),e.qZA()()()()()),2&t&&(e.xp6(8),e.Q6J("columns",o.columns)("data",o.residentialOrderSummary))},dependencies:[S.a],styles:[".table[_ngcontent-%COMP%]   .thead-light[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#fff!important;background-color:#222633!important;border-color:#222633!important}.text-color[_ngcontent-%COMP%]{color:#a9adbb!important}.border[_ngcontent-%COMP%]{border:none!important}.m-10[_ngcontent-%COMP%]{margin-top:10rem!important}"]}),n})();function Ve(n,r){if(1&n&&(e.TgZ(0,"div",7)(1,"label",8),e._uU(2,"Total Entered Plan Data : "),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.hij(" ",t.planData," ")}}function Be(n,r){if(1&n&&(e.TgZ(0,"div",7)(1,"label",8),e._uU(2,"Selected Plan Qty : "),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.hij(" ",null==t.previewTokenData?null:t.previewTokenData.noOfProxies," ")}}function Xe(n,r){1&n&&e._UZ(0,"span",14)}let ee=(()=>{class n{constructor(t,o,i){this.customModalService=t,this.authService=o,this.adminService=i,this.previewTokenData={},this.isDatacenterPlan=!1,this.generatedSummary=new e.vpe,this.checkUserCountIndex=0,this.generatingToken=!1,this.summaryReport=[]}ngOnInit(){}closeModel(){this.customModalService.close("plan-preview-token")}createResidentialToken(){if(this.checkUserCountIndex>=this.previewTokenData.email?.length)return this.generatingToken=!1,this.generatedSummary.emit(this.summaryReport),void this.customModalService.close("plan-preview-token",{createToken:!0});this.generatingToken=!0,this.checkUserRegisteredOrNot(this.previewTokenData?.email,this.checkUserCountIndex)}checkUserRegisteredOrNot(t,o=0){this.authService.checkIfEmailExist({userName:t[o]}).subscribe(i=>{i?this.createTokenOfResidential(t[o]):(this.summaryReport.push({id:o,email:t[o],message:'<span class="tokenError">Email not registered!</span>'}),this.checkUserCountIndex++,this.createResidentialToken())},i=>{this.summaryReport.push({id:o,email:t[o],message:'<span class="tokenError">Email not registered!</span>'}),this.checkUserCountIndex++,this.checkUserCountIndex>o&&(this.generatingToken=!1)})}get planData(){return(0,H.En)("GB",this.previewTokenData?.dataLimitMegaBytes,!0)+"GB"}createTokenOfResidential(t){const o={...this.previewTokenData,email:this.previewTokenData.email[this.checkUserCountIndex]};this.adminService.createResidentialToken(o).subscribe(i=>{i?.error?this.summaryReport.push({id:this.checkUserCountIndex,email:t,message:'<span class="tokenError">Failed!</span>'}):(this.checkUserCountIndex++,this.summaryReport.push({id:this.checkUserCountIndex,email:t,message:`<span class="tokenSuccess">${"Created! "+i.name}</span>`})),this.createResidentialToken()},i=>{this.generatingToken=!1,this.closeModel(),this.summaryReport.push({id:this.checkUserCountIndex,email:t,message:'<span class="tokenError">Failed!</span>'})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(k.k),e.Y36(J.$h),e.Y36(T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-res-preview-token"]],inputs:{previewTokenData:"previewTokenData",isDatacenterPlan:"isDatacenterPlan"},outputs:{generatedSummary:"generatedSummary"},decls:20,vars:14,consts:[[1,"layout"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","myModalLabel"],[1,"modal-body"],[2,"padding","10px"],[1,"form-group"],[2,"font-weight","bold"],["class","form-group",4,"ngIf"],[1,"modal-footer","residential-preview-token-footer"],[3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["type","button",1,"btn","oculus_btn","border","close-btn",3,"disabled","click"],["role","status",1,"spinner-border","spinner-border-sm"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),e._uU(5,"Token Create Preview"),e.qZA()(),e.TgZ(6,"div",5)(7,"form",6)(8,"div",7)(9,"label",8),e._uU(10,"Total Entered Email Accounts : "),e.qZA(),e._uU(11),e.qZA(),e.YNc(12,Ve,4,1,"div",9),e.YNc(13,Be,4,1,"div",9),e.qZA()(),e.TgZ(14,"div",10)(15,"button",11),e.NdJ("click",function(){return o.createResidentialToken()}),e.YNc(16,Xe,1,0,"span",12),e._uU(17),e.qZA(),e.TgZ(18,"button",13),e.NdJ("click",function(){return o.closeModel()}),e._uU(19," Close "),e.qZA()()()()()),2&t&&(e.xp6(11),e.hij(" ",null==o.previewTokenData||null==o.previewTokenData.email?null:o.previewTokenData.email.length," "),e.xp6(1),e.Q6J("ngIf",!o.isDatacenterPlan),e.xp6(1),e.Q6J("ngIf",o.isDatacenterPlan),e.xp6(2),e.Gre("oculus_btn border ",o.generatingToken?"assigning-count-btn":""," save-btn"),e.ekj("btn-disabled",o.generatingToken),e.Q6J("disabled",o.generatingToken),e.xp6(1),e.Q6J("ngIf",o.generatingToken),e.xp6(1),e.hij(" ",o.generatingToken?o.checkUserCountIndex+" created out of "+(null==o.previewTokenData||null==o.previewTokenData.email?null:o.previewTokenData.email.length):"Create"," "),e.xp6(1),e.ekj("btn-disabled",o.generatingToken),e.Q6J("disabled",o.generatingToken))},dependencies:[m.O5,a._Y,a.JL,a.F],styles:["@media (min-width: 1024px){.custom-modal{width:40%!important}}.residential-preview-token-footer .close-btn{color:#fff;background:#6c757d;border-color:#6c757d!important}.residential-preview-token-footer .close-btn:hover{color:#fff!important;background-image:linear-gradient(90deg,#60f9bf 0%,#0099a5 100%)!important}.border{border:none!important}.assigning-count-btn{width:max-content!important;padding:0 18px}.mt-10{margin-top:10rem}.size{width:3rem}.scroll{overflow-x:hidden!important;overflow-y:auto!important}\n"],encapsulation:2}),n})();function je(n,r){if(1&n&&(e.TgZ(0,"option",23),e._UZ(1,"div",24),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",null==t?null:t.plan_masterId),e.xp6(1),e.Q6J("innerHTML",null==t?null:t.plan_label,e.oJD)}}function Ke(n,r){if(1&n&&(e.TgZ(0,"option",23),e._UZ(1,"div",24),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.Q6J("innerHTML",null==t?null:t.plan_name,e.oJD)}}function Ge(n,r){if(1&n&&(e.TgZ(0,"option",23),e._UZ(1,"div",24),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.Q6J("innerHTML",null==t?null:t.title,e.oJD)}}function $e(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"custom-modal",25),e.NdJ("onClose",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.closePlanPreviewPopup(i))}),e.TgZ(1,"app-res-preview-token",26),e.NdJ("generatedSummary",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.generatedResidentialTokenSummary(i))}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("previewTokenData",t.previewTokenData)}}function He(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"custom-modal",27),e.NdJ("onClose",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closeTokenSummaryPopup())}),e._UZ(1,"app-res-token-summary",28),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("residentialOrderSummary",t.residentialOrderSummary)}}const We=function(){return{standalone:!0}};let et=(()=>{class n{constructor(t,o,i,s){this.formBuilder=t,this.toastr=o,this.homeService=i,this.customModalService=s,this.allEmails=[],this.residentialTokenCreateCount=0,this.residentialOrderSummary=[],this.previewTokenData={},this.progressTokenData={},this.openPlanPreviewToken=!1,this.openPreviewTokenCreate=!1,this.openTokenSummary=!1,this.isCancel=!1,this.loader=!1,this.tokenCreateResult=[],this.tokenCreateObj={},this.residentialProxies=[],this.residentialCardPlansData=null,this.residentialCardPlans=[2,4,5,6],this.keyOfTypeSelectionEnum=_,this.privateReserveStock=0,this.typeOfPlanData=[{id:0,key:_.DEFAULT,title:"Default"},{id:1,key:_.CUSTOM,title:"Custom"}],this.selectedPlanType=this.typeOfPlanData[0]}ngOnInit(){this.initializeForm()}handleChangeEventOfResidentialPlan(){this.planId.valueChanges.subscribe(t=>{this.residentialCardPlansData=this.residentialProxies.find(o=>o.plan_masterId===t)||[],this.setValueToControl("size_in_gb",this.residentialCardPlansData?.residentialPlans[0])})}changeTypeOfPlan(t){t.key===_.DEFAULT?(this.number_of_proxies.disable(),this.size_in_mb.disable(),this.size_in_gb.enable()):(this.number_of_proxies.enable(),this.size_in_mb.enable(),this.size_in_gb.disable())}getResidentialProxies(){this.homeService.getPrivateReserveStock().subscribe(t=>{this.privateReserveStock=t?.amount||0,this.homeService.getResidentialProxies().subscribe(o=>{this.residentialProxies=this.homeService.groupingResidentialProxies(o,this.residentialCardPlans),this.residentialProxies=[...this.residentialProxies.map(i=>(0,ze.Ps)(i))],this.residentialCardPlansData=this.residentialProxies?.[0],this.setValueToControl("planId",this.residentialProxies?.[0].plan_masterId),this.setValueToControl("size_in_gb",this.residentialCardPlansData?.residentialPlans?.[0])})})}setValueToControl(t,o){this.residentialTokenAllocationForm.controls[t].setValue(o),this.residentialTokenAllocationForm.updateValueAndValidity()}initializeForm(){this.residentialTokenAllocationForm=this.formBuilder.group({planId:["",a.kI.required],size_in_gb:["",a.kI.required],size_in_mb:["",a.kI.required],userEmail:["",a.kI.required],number_of_proxies:["",a.kI.required]}),this.handleChangeEventOfResidentialPlan(),this.getResidentialProxies()}get planFormControls(){return this.residentialTokenAllocationForm.controls}get planFormData(){return this.residentialTokenAllocationForm.value}previewResidentialTokenCreate(){const t=this.planFormControls.userEmail.value?.split(",")||[];if(!this.setValidationForm(t))return void this.showMessage(c.xZ.wrongEmailErrorMessage);if(this.checkValidationOfData(this.selectedPlanType.key)||this.residentialCardPlansData?.master_plan_name===G.Jb.OCULUS_PRIVATE_RESERVE&&this.checkStockForOculusPrivateReserve()){this.loader=!1;let s=this.size_in_mb.value<0||!this.size_in_mb.value?c.xZ.planDataValidationErrorMessage:c.xZ.noOfProxiesValidationErrorMessage,v=c.xZ.validationErrorMessage;return this.residentialCardPlansData?.master_plan_name===G.Jb.OCULUS_PRIVATE_RESERVE&&this.checkStockForOculusPrivateReserve()&&(s=c.xZ.outOfStockErrorMessage,v=c.xZ.error),void this.showMessage(s,v)}this.allEmails=U(t);const i=this.selectedPlanType.key===_.DEFAULT?(0,H.gk)(this.planFormData?.size_in_gb?.plan_name):+this.planFormData?.size_in_mb;this.previewTokenData=this.generatePayload(i),this.openPlanPreviewToken=!0,this.customModalService.open("plan-preview-token")}get number_of_proxies(){return this.residentialTokenAllocationForm.get("number_of_proxies")}get size_in_mb(){return this.residentialTokenAllocationForm.get("size_in_mb")}get size_in_gb(){return this.residentialTokenAllocationForm.get("size_in_gb")}get planId(){return this.residentialTokenAllocationForm.get("planId")}generatePayload(t){return{email:this.allEmails,planType:this.homeService.getResidentialPlan(+this.planId.value),planId:this.selectedPlanType?.key===_.DEFAULT?+this.size_in_gb.value?.residentail_plans_id:"",dataLimitMegaBytes:t?.toString(),numberOfProxies:this.selectedPlanType?.key===_.DEFAULT?"":this.number_of_proxies.value}}closePlanPreviewPopup(t){this.openPlanPreviewToken=!1,t&&t.createToken&&(this.openTokenSummary=!0,this.customModalService.open("token-summary"))}checkStockForOculusPrivateReserve(){return+this.size_in_gb.value?.no_of_proxies>this.privateReserveStock||+this.number_of_proxies?.value>this.privateReserveStock}checkValidationOfData(t){switch(t){case _.DEFAULT:return!this.size_in_gb.value||+this.size_in_gb.value<0;case _.CUSTOM:return!this.size_in_mb.value||+this.size_in_mb.value<0||!this.number_of_proxies.value||+this.number_of_proxies.value<0;default:return!this.size_in_gb.value||+this.size_in_gb.value<0}}setValidationForm(t){return!t||!t.length||t.every(F.K)}generatedResidentialTokenSummary(t){this.residentialOrderSummary=t}showMessage(t,o){"success"===o&&this.toastr.success(t,o||c.xZ.success),this.toastr.error(t,o||c.xZ.error)}closeTokenSummaryPopup(){this.openTokenSummary=!1,this.initializeForm()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(a.QS),e.Y36(P._W),e.Y36(J.YD),e.Y36(k.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-residential-token-allocation"]],decls:41,vars:16,consts:[[1,"admin-layout","residential-token-allocation-section","contentPart","layout","mt-5"],[1,"container"],[1,"fs-table-header"],[1,"card","p-4",3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-4"],["for","inputState"],["id","inputState","formControlName","planId",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["for","planData"],["id","inputState","formControlName","size_in_gb",1,"form-control"],[1,"text-center","d-flex","justify-content-center","align-items-center","m-2"],[1,"divider","mr-3","ml-3"],[1,"custom-radio-btn"],["id","inputState",1,"form-control","plan-select-type",3,"ngModel","ngModelOptions","ngModelChange"],["id","planData","type","number","min","0","formControlName","size_in_mb",1,"form-control"],[1,"mt-4"],["id","planData","type","number","min","0","formControlName","number_of_proxies",1,"form-control"],["type","text","rows","3","cols","6","placeholder","Enter valid emails","formControlName","userEmail",1,"form-control"],[1,"d-flex","flex-row-reverse"],[1,"border","oculus_btn",3,"click"],["class","admin-layout","id","plan-preview-token",3,"onClose",4,"ngIf"],["id","token-summary","class","admin-layout","theme","dark",3,"onClose",4,"ngIf"],[3,"ngValue"],[1,"m-4","cursor-pointer",3,"innerHTML"],["id","plan-preview-token",1,"admin-layout",3,"onClose"],[3,"previewTokenData","generatedSummary"],["id","token-summary","theme","dark",1,"admin-layout",3,"onClose"],[1,"scroll",3,"residentialOrderSummary"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Residential Proxies Allocation"),e.qZA(),e._UZ(4,"hr"),e.TgZ(5,"form",3)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Residential Plans"),e.qZA(),e.TgZ(10,"select",7),e.YNc(11,je,2,2,"option",8),e.qZA()(),e.TgZ(12,"div",5)(13,"div")(14,"label",9),e._uU(15,"Plan Data (GB)"),e.qZA()(),e.TgZ(16,"div")(17,"select",10),e.YNc(18,Ke,2,2,"option",8),e.qZA()(),e.TgZ(19,"div",11),e._UZ(20,"div",12),e.TgZ(21,"div",13)(22,"select",14),e.NdJ("ngModelChange",function(s){return o.selectedPlanType=s})("ngModelChange",function(s){return o.changeTypeOfPlan(s)}),e.YNc(23,Ge,2,2,"option",8),e.qZA()(),e._UZ(24,"div",12),e.qZA(),e.TgZ(25,"div")(26,"label"),e._uU(27,"Enter plan data (MB)"),e.qZA(),e._UZ(28,"input",15),e.TgZ(29,"label",16),e._uU(30,"No of proxies"),e.qZA(),e._UZ(31,"input",17),e.qZA()(),e.TgZ(32,"div",5)(33,"label",6),e._uU(34,"Enter User Emails (Separated By Comma)"),e.qZA(),e._UZ(35,"textarea",18),e.qZA()(),e.TgZ(36,"div",19)(37,"button",20),e.NdJ("click",function(){return o.previewResidentialTokenCreate()}),e._uU(38," Save "),e.qZA()()()()(),e.YNc(39,$e,2,1,"custom-modal",21),e.YNc(40,He,2,1,"custom-modal",22)),2&t&&(e.Q6J("@fade",void 0),e.xp6(5),e.Q6J("formGroup",o.residentialTokenAllocationForm),e.xp6(6),e.Q6J("ngForOf",o.residentialProxies),e.xp6(6),e.ekj("disabled-control",o.selectedPlanType.key===o.keyOfTypeSelectionEnum.CUSTOM),e.xp6(1),e.Q6J("ngForOf",null==o.residentialCardPlansData?null:o.residentialCardPlansData.residentialPlans),e.xp6(4),e.Q6J("ngModel",o.selectedPlanType)("ngModelOptions",e.DdM(15,We)),e.xp6(1),e.Q6J("ngForOf",o.typeOfPlanData),e.xp6(5),e.ekj("disabled-control",o.selectedPlanType.key===o.keyOfTypeSelectionEnum.DEFAULT),e.xp6(3),e.ekj("disabled-control",o.selectedPlanType.key===o.keyOfTypeSelectionEnum.DEFAULT),e.xp6(8),e.Q6J("ngIf",o.openPlanPreviewToken),e.xp6(1),e.Q6J("ngIf",o.openTokenSummary))},dependencies:[m.sg,m.O5,a._Y,a.YN,a.Kr,a.Fj,a.wV,a.EJ,a.JJ,a.JL,a.qQ,a.sg,a.u,a.On,W,ee,Z.R],styles:[".admin-layout[_ngcontent-%COMP%]   .panel_dark[_ngcontent-%COMP%]{padding:50px!important;border-radius:5px!important;background-color:#2e3342!important;border:1px solid rgb(65,71,90)!important;color:#bbb!important;box-shadow:0 0 40px #0006!important}.admin-layout[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:3px!important;background-color:#f8f8fb!important;background-clip:padding-box!important;border:1px solid #4b5167!important;color:#4b4f55!important}.admin-layout[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:none!important}.admin-layout[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#41b787!important;transition:all 0s!important}.admin-layout[_ngcontent-%COMP%]   .red[_ngcontent-%COMP%]{color:red}.admin-layout[_ngcontent-%COMP%]   .scroll[_ngcontent-%COMP%]{overflow-y:hidden;overflow-x:scroll}.admin-layout[_ngcontent-%COMP%]   .btn-disabled[_ngcontent-%COMP%]{background:#9d9d9d!important;cursor:auto!important}.admin-layout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#222633}.admin-layout[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:40%!important}.admin-layout[_ngcontent-%COMP%]   .plan-select-type[_ngcontent-%COMP%]{min-width:100px}.admin-layout[_ngcontent-%COMP%]   .disabled-control[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}"],data:{animation:[(0,d.X$)("fade",[(0,d.eR)("void => *",[(0,d.oB)({opacity:0}),(0,d.jt)(700,(0,d.oB)({opacity:1}))])])]}}),n})();var tt=l(5861),ot=l(3679);const nt=["formTokenAllocationEl"],it=["ngOtpInput"];function at(n,r){if(1&n&&(e.TgZ(0,"option",43),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",null==t||null==t.proxyLocation?null:t.proxyLocation.locationDisplayName," ")}}function rt(n,r){if(1&n&&(e.TgZ(0,"option",43),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.AsE(" ",null==t?null:t.ip," (",null==t?null:t.instock,") ")}}function st(n,r){if(1&n&&(e.TgZ(0,"option",43),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",null==t?null:t.proxyDurationLabel," ")}}function lt(n,r){if(1&n&&(e.TgZ(0,"option",43),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.hij(" ",null==t?null:t.noOfProxies," ")}}function ct(n,r){if(1&n&&(e.TgZ(0,"span",29),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.allEmails.length,"")}}function dt(n,r){if(1&n&&(e.TgZ(0,"div",26)(1,"label",27),e._uU(2,"Required Stock : "),e.qZA(),e._uU(3),e.TgZ(4,"span",29),e._uU(5),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.AsE(" (Total Emails * Selected Qty) = (",t.allEmails.length," * ",null==t.selectedProxy?null:t.selectedProxy.noOfProxies,") = "),e.xp6(2),e.hij(" ",t.getTotalProxies(t.allEmails.length,+(null==t.selectedProxy?null:t.selectedProxy.noOfProxies)),"")}}function pt(n,r){1&n&&e._UZ(0,"span",44)}let ut=(()=>{class n{constructor(t,o,i,s){this.tokenAllocationService=t,this.toastr=o,this.fb=i,this.changeDetectRef=s,this.showOtpComponent=!0,this.showEmailField=!0,this.showPasswordField=!0,this.staticAnyServer="Any Server",this.assignEmailIndex=0,this.config={allowNumbersOnly:!0,length:6,isPasswordInput:!1,disableAutoFocus:!1,placeholder:"",inputStyles:{width:"50px",height:"50px"}},this.defaultCountry=ot.h[0],this.enable2fa=!1,this.email="",this.returnUrl="",this.tokenAllocationRequest={},this.isLoading=!1,this.isLoader=!1,this.regions=[],this.servers=[],this.proxyDurationHrs=[],this.proxyQty=[],this.proxiesPlans=[],this.openTokenCreatePreview=!1,this.create_token_modal=!1,this.createTokenSummary=!1,this.progressPercentage=0,this.allEmails=[],this.isValidationSuccess=!1,this.columns=[{index:0,key:"orderIndex",displayLabel:"#",type:u.X.NUMBER},{index:1,key:"email",displayLabel:"EMAIL",type:u.X.TEXT},{index:2,key:"message",displayLabel:"STATUS",type:u.X.TEXT}],this.tokenUserSummary=[],this.allocatedTokenUserSummary=[]}ngOnInit(){this.formTokenAllocation=this.fb.group({chooseRegion:new a.p4(null,[a.kI.required]),chooseServer:new a.p4(null,[a.kI.required]),chooseProxyDuration:new a.p4(null,[a.kI.required]),chooseProxyQty:new a.p4(null,[a.kI.required]),userEmails:new a.p4("",[a.kI.required])}),this.formTokenAllocation?.get("chooseRegion")?.valueChanges.subscribe(t=>{this.selectedRegion=t,this.changeRegion(t)}),this.getProxyServerStock()}get f(){return this.formTokenAllocation.controls}setFormInputFocus(){for(const t of Object.keys(this.formTokenAllocation.controls))if(this.formTokenAllocation.controls[t].invalid){this.formTokenAllocationEl.nativeElement.querySelector('[formcontrolname="'+t+'"]').focus();break}}changeDuration(){this.fillQty(this.selectedRegion.proxyLocation.locationName,this.selectedDuration.proxyDurationLabel)}changeRegion(t){this.fillServers(this.selectedRegion.proxyLocation.locationName),this.fillDuration(this.selectedRegion.proxyLocation.locationName),this.fillQty(this.selectedRegion.proxyLocation.locationName,this.selectedDuration.proxyDurationLabel)}getAllProxies(){this.tokenAllocationService.getAllProxies().subscribe(t=>{this.proxiesPlans=t,t.forEach(i=>{p.find(this.regions,{proxyLocation:{locationName:i.proxyLocation.locationName}})||this.regions.push(i)}),this.selectedRegion=p.first(this.regions);let o=this.selectedRegion.proxyLocation.locationName;this.fillServers(o),this.fillDuration(o),this.fillQty(o,this.selectedDuration.proxyDurationLabel),this.formTokenAllocation?.get("chooseRegion")?.setValue(this.selectedRegion),this.formTokenAllocation?.get("chooseServer")?.setValue(this.selectedServer),this.formTokenAllocation?.get("chooseProxyDuration")?.setValue(this.selectedDuration),this.formTokenAllocation?.get("chooseProxyQty")?.setValue(this.selectedQty)})}getProxyServerStock(){this.tokenAllocationService.getProxyServerStock().subscribe(t=>{this.serverStocks=t,this.getAllProxies()})}fillServers(t){this.servers=[];let i=p.find(this.serverStocks,{servername:"New York"==t?"NewYork":t});this.servers=[...i.servers],this.servers.splice(0,0,{ip:this.staticAnyServer,instock:i.total,isDefault:!0}),this.selectedServer=p.first(this.servers),this.formTokenAllocation.get("chooseServer")?.setValue(this.selectedServer)}fillDuration(t){this.durations=[],p.forEach(this.proxiesPlans,o=>{o.proxyLocation.locationName==t&&!p.find(this.durations,{proxyDurationLabel:o.proxyDurationLabel})&&this.durations.push(o)}),this.durations=p.sortBy(this.durations,o=>o.proxyDurationHrs),this.selectedDuration=p.first(this.durations),this.formTokenAllocation.get("chooseProxyDuration")?.setValue(this.selectedDuration)}fillQty(t,o){this.qty=[],p.forEach(this.proxiesPlans,i=>{i.proxyLocation.locationName==t&&i.proxyDurationLabel==o&&!p.find(this.qty,{noOfProxies:i.noOfProxies})&&this.qty.push(i)}),this.qty=p.sortBy(this.qty,"noOfProxies"),this.selectedQty=p.first(this.qty),this.formTokenAllocation.get("chooseProxyQty")?.setValue(this.selectedQty)}saveTokenAllocation(){var t=this;return(0,tt.Z)(function*(){t.setFormInputFocus();const o=t.formTokenAllocation.get("userEmails")?.value?.split(",")||[];if(t.setValidationForm(o)){if(t.formTokenAllocation.valid){let{locationDisplayName:v}=t.formTokenAllocation.controls?.chooseProxyQty?.value?.proxyLocation,{proxyDurationLabel:R}=t.formTokenAllocation?.controls?.chooseProxyDuration?.value,{noOfProxies:O}=t.formTokenAllocation?.controls?.chooseProxyQty?.value;if(yield t.setSelectedProxy(v,R,O),t.formTokenAllocation.controls.chooseServer.value&&t.selectedProxy&&t.formTokenAllocation.controls.chooseServer.value.instock<t.selectedProxy.noOfProxies*o.length)return void t.showMessage(c.xZ.outOfStockErrorMessage,c.xZ.outOfStockErrorTitle);t.allEmails=U(o),$("#tokenCreatePreview").modal("show"),$("#tokenCreatePreview").modal({backdrop:"static",keyboard:!1})}}else t.showMessage(c.xZ.wrongEmailErrorMessage)})()}createToken(){this.assignEmailIndex>=this.allEmails.length?(0,p.delay)(()=>{this.isLoading=!1,this.formTokenAllocation.controls.userEmails.reset(),this.tokenAllocationRequest={proxyDataId:this.selectedProxy?.id||"",userName:this.allEmails},this.getProxyServerStock(),$("#tokenCreatePreview").modal("hide"),$("#createTokenSummary").modal("show"),$("#createTokenSummary").modal({backdrop:"static",keyboard:!1}),this.allocatedTokenUserSummary=[...this.tokenUserSummary]},200):(this.isLoading=!0,this.tokenAllocationRequest={proxyDataId:this.selectedProxy?.id,serverIp:this.formTokenAllocation.controls.chooseServer?.value?.ip!==this.staticAnyServer?this.formTokenAllocation.controls.chooseServer?.value?.ip:null,userName:Array(this.allEmails[this.assignEmailIndex])},this.tokenAllocationService.createISPToken(this.tokenAllocationRequest).subscribe(o=>{this.assignEmailIndex++,this.tokenUserSummary.push({id:`${this.assignEmailIndex}`,email:o[0]?.userName,message:(o[0]?.success?`<span class="tokenSuccess">${o[0]?.successMessage||""}</span>`:`<span class="tokenError">${"noStockError"===o[0]?.failMessage?"Out of stock!":"Email not registered!"}</span>`)||""}),this.createToken()},o=>{this.isLoading=!1,o||this.showMessage(c.xZ.internalServerErrorMessage,c.xZ.serverErrorTitle)}))}setValidationForm(t){return!t||!t.length||t.every(F.K)}showMessage(t,o){"success"===o&&this.toastr.success(t,o||c.xZ.success),this.toastr.error(t,o||c.xZ.error)}setSelectedProxy(t,o,i){this.selectedProxy=p.find(this.proxiesPlans,s=>+s.noOfProxies===i&&(s.proxyLocation?.locationDisplayName===t||s.proxyLocation?.locationName===t)&&s.proxyDurationLabel===o)}close(){$("#createTokenSummary").modal("hide"),this.setTimeout=setTimeout(()=>{this.assignEmailIndex=0,this.tokenUserSummary=[],this.allocatedTokenUserSummary=[]},0)}getTotalProxies(t,o){return t*o}getPercentageOfCount(){return 100*this.assignEmailIndex/+this.allEmails.length}ngOnDestroy(){this.setTimeout&&clearTimeout(this.setTimeout)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(K),e.Y36(P._W),e.Y36(a.QS),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-token-allocation"]],viewQuery:function(t,o){if(1&t&&(e.Gf(nt,5),e.Gf(it,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.formTokenAllocationEl=i.first),e.iGM(i=e.CRH())&&(o.ngOtpInput=i.first)}},decls:83,vars:23,consts:[[1,"admin-layout","layout","mt-5"],[1,"terms-conditions-section","contentPart"],[1,"container"],[1,"fs-table-header"],[1,"card","p-4",3,"formGroup","ngSubmit"],["formTokenAllocationEl",""],[1,"row"],[1,"col-md-8"],[1,"form-group","col-md-6"],["for","inputState"],["formControlName","chooseRegion",1,"form-control"],[3,"ngValue",4,"ngFor","ngForOf"],["id","inputState","formControlName","chooseServer",1,"form-control"],["id","inputState","formControlName","chooseProxyDuration",1,"form-control",3,"change"],["id","inputState","formControlName","chooseProxyQty",1,"form-control"],[1,"form-group","col-md-4"],["type","text","rows","3","cols","6","formControlName","userEmails","placeholder","Enter valid emails",1,"form-control"],[1,"d-flex","flex-row-reverse"],["type","submit","name","submit",1,"oculus_btn"],["id","tokenCreatePreview","tabindex","-1","data-backdrop","static","data-keyboard","false","role","dialog","aria-labelledby","tokenCreatePreview",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","myModalLabel",1,"modal-title"],[1,"modal-body"],[1,"ng-valid",2,"padding","10px"],[1,"form-group"],[2,"font-weight","bold"],["class","text-white",4,"ngIf"],[1,"text-white"],["class","form-group",4,"ngIf"],[1,"modal-footer"],["type","button","data-dismiss","modal",3,"disabled","click"],["class","spinner-border spinner-border-sm mr-2","role","status","aria-hidden","true",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-default","btn-secondary",3,"disabled"],["id","createTokenSummary","tabindex","-1","role","dialog","data-backdrop","static","data-keyboard","false","aria-labelledby","myModalLabel",1,"modal","fade"],[1,"modal-dialog","modal-lg","upgrade-modal"],[1,"modal-content","table-content"],[1,"modal-title"],[1,"col-12"],[1,"my-orders-part"],[3,"columns","data"],["type","button","data-dismiss","modal",1,"btn","btn-default","btn-secondary",3,"click"],[3,"ngValue"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","mr-2"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4,"Premium DC ISP Proxies Allocation"),e.qZA(),e._UZ(5,"hr"),e.TgZ(6,"form",4,5),e.NdJ("ngSubmit",function(){return o.saveTokenAllocation()}),e.TgZ(8,"div",6)(9,"div",7)(10,"div",6)(11,"div",8)(12,"label",9),e._uU(13,"Choose Region"),e.qZA(),e.TgZ(14,"select",10),e.YNc(15,at,2,2,"option",11),e.qZA()(),e.TgZ(16,"div",8)(17,"label",9),e._uU(18,"Choose Server"),e.qZA(),e.TgZ(19,"select",12),e.YNc(20,rt,2,3,"option",11),e.qZA()(),e.TgZ(21,"div",8)(22,"label",9),e._uU(23,"Choose Proxy Duration"),e.qZA(),e.TgZ(24,"select",13),e.NdJ("change",function(){return o.changeDuration()}),e.YNc(25,st,2,2,"option",11),e.qZA()(),e.TgZ(26,"div",8)(27,"label",9),e._uU(28,"Choose Proxy Qty"),e.qZA(),e.TgZ(29,"select",14),e.YNc(30,lt,2,2,"option",11),e.qZA()()()(),e.TgZ(31,"div",15)(32,"label",9),e._uU(33,"Enter User Emails (Separated By Comma)"),e.qZA(),e._UZ(34,"textarea",16),e.qZA()(),e.TgZ(35,"div",17)(36,"button",18),e._uU(37,"Save"),e.qZA()()()()()(),e.TgZ(38,"div",19)(39,"div",20)(40,"div",21)(41,"div",22)(42,"h4",23),e._uU(43,"Token Create Preview"),e.qZA()(),e.TgZ(44,"div",24)(45,"form",25)(46,"div",26)(47,"label",27),e._uU(48,"Total Entered Email Accounts : "),e.qZA(),e.YNc(49,ct,2,1,"span",28),e.qZA(),e.TgZ(50,"div",26)(51,"label",27),e._uU(52,"Selected Plan Qty : "),e.qZA(),e.TgZ(53,"span",29),e._uU(54),e.qZA()(),e.TgZ(55,"div",26)(56,"label",27),e._uU(57,"Available Stock in Selected Region/Server : "),e.qZA(),e.TgZ(58,"span",29),e._uU(59),e.qZA()(),e.YNc(60,dt,6,3,"div",30),e.qZA()(),e.TgZ(61,"div",31)(62,"button",32),e.NdJ("click",function(){return o.createToken()}),e.YNc(63,pt,1,0,"span",33),e._uU(64),e.qZA(),e.TgZ(65,"button",34),e._uU(66," Close "),e.qZA()()()()(),e.TgZ(67,"div",35)(68,"div",36)(69,"div",37)(70,"div",22)(71,"h5",38),e._uU(72,"Create Token Summary"),e.qZA()(),e.TgZ(73,"div",24)(74,"div")(75,"div",2)(76,"div",6)(77,"div",39)(78,"div",40),e._UZ(79,"app-table",41),e.qZA()()()()()(),e.TgZ(80,"div",31)(81,"button",42),e.NdJ("click",function(){return o.close()}),e._uU(82," Close "),e.qZA()()()()()),2&t&&(e.Q6J("@fade",void 0),e.xp6(6),e.Q6J("formGroup",o.formTokenAllocation),e.xp6(9),e.Q6J("ngForOf",o.regions),e.xp6(5),e.Q6J("ngForOf",o.servers),e.xp6(5),e.Q6J("ngForOf",o.durations),e.xp6(5),e.Q6J("ngForOf",o.qty),e.xp6(19),e.Q6J("ngIf",o.allEmails),e.xp6(5),e.hij(" ",null==o.selectedProxy?null:o.selectedProxy.noOfProxies,""),e.xp6(5),e.hij(" ",null==o.formTokenAllocation.controls.chooseServer.value?null:o.formTokenAllocation.controls.chooseServer.value.instock,""),e.xp6(1),e.Q6J("ngIf",o.allEmails),e.xp6(2),e.Gre("oculus_btn ",o.isLoading?"assigning-count-btn":"",""),e.ekj("btn-disabled",o.isLoading),e.Q6J("disabled",o.isLoading),e.xp6(1),e.Q6J("ngIf",o.isLoading),e.xp6(1),e.hij(" ",o.isLoading?o.assignEmailIndex+" created out of "+o.allEmails.length:"Create"," "),e.xp6(1),e.ekj("btn-disabled",o.isLoading),e.Q6J("disabled",o.isLoading),e.xp6(14),e.Q6J("columns",o.columns)("data",o.allocatedTokenUserSummary))},dependencies:[m.sg,m.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,a.F,S.a],styles:['.admin-layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]{margin:5% 40%}.admin-layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .top-bar[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.admin-layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .top-bar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:26px;color:#fff;line-height:normal;text-align:center;text-transform:capitalize}.admin-layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .top-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:60px;border-style:solid;border-width:2px;border-image-source:linear-gradient(265deg,#0091a7,#ccff90);border-image-slice:1;display:block;margin:14px auto 0}.admin-layout[_ngcontent-%COMP%]   .position[_ngcontent-%COMP%]   .lable-color[_ngcontent-%COMP%]{padding:5px 0;color:#000}.admin-layout[_ngcontent-%COMP%]   .btn-disabled[_ngcontent-%COMP%]{background:#9d9d9d!important;cursor:auto!important}.admin-layout[_ngcontent-%COMP%]   .register-content[_ngcontent-%COMP%]{max-width:380px;margin:4% 0;border-radius:5px;background-color:#fff;box-shadow:0 2px 4px #00000080;color:#000}.admin-layout[_ngcontent-%COMP%]   .register-form[_ngcontent-%COMP%]{padding:2.5rem 2.625rem}@media only screen and (min-width: 992px){.admin-layout[_ngcontent-%COMP%]   register-form[_ngcontent-%COMP%]{padding:40px 42px}}.admin-layout   [_nghost-%COMP%]     .form-inputRow{margin-bottom:20px}.admin-layout   [_nghost-%COMP%]     .form-inputRow .country-code .country-code-picker{padding:0!important}.admin-layout   [_nghost-%COMP%]     .form-inputRow .country-code .form-control{font-family:Circular!important;font-size:14px;font-weight:500;line-height:normal;width:100%;border-radius:3px;outline:none;height:48px;background-color:#f8fafd!important;border:solid 1px #cbd3df!important}.admin-layout[_ngcontent-%COMP%]   .register-input-control[_ngcontent-%COMP%]{font-family:roboto;font-size:14px;font-weight:500;line-height:normal;color:#002c60;width:100%;border-radius:3px;outline:none;background-color:#f8fafd;border:solid 1px #add8e6;padding:16px 10px 15px 20px}.admin-layout[_ngcontent-%COMP%]   .register-input-control.error-msg[_ngcontent-%COMP%]{border-color:#ff0004}.admin-layout[_ngcontent-%COMP%]   .register-input-control[_ngcontent-%COMP%]::placeholder{color:#999}.admin-layout[_ngcontent-%COMP%]   .submit_btn[_ngcontent-%COMP%]{font-family:roboto;font-size:14px;font-weight:500;line-height:45px;height:45px;color:#fff;width:100%;border-radius:3px;border:none;outline:none;cursor:pointer;background-image:linear-gradient(to right,#0099a5,#41b787);box-shadow:0 2px 3px #75757580;transition:all .2s ease-in-out}.admin-layout[_ngcontent-%COMP%]   .submit_btn[_ngcontent-%COMP%]:hover{background-image:linear-gradient(to right,#41b787,#41b787)}.admin-layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]{border-top:1px solid #dbe2ec;padding:22px 0 40px}.admin-layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#a4a9bb;line-height:normal;text-align:center}.admin-layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;color:#002c60}.admin-layout[_ngcontent-%COMP%]   .alreadyAccount[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#41b787}.admin-layout[_ngcontent-%COMP%]   .g-recaptcha-response[_ngcontent-%COMP%]{width:250px;height:40px;border:1px solid rgb(193,193,193);margin:10px 25px;padding:0;resize:none;display:none}.admin-layout[_ngcontent-%COMP%]   .otp_textbox[_ngcontent-%COMP%]{width:45px;height:50px;padding:12px 4px 16px;margin:5px;font-size:45px;font-weight:700;text-indent:5px;color:#002c60;border-radius:3px;outline:none;background-color:#f8fafd;border:solid 1px #cbd3df}.admin-layout[_ngcontent-%COMP%]   .form-inputRow[_ngcontent-%COMP%]{margin-bottom:20px}.admin-layout[_ngcontent-%COMP%]   .otp_title[_ngcontent-%COMP%]{margin-bottom:20px;display:block;font-weight:"500"}.admin-layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:roboto,sans-serif;-webkit-appearance:none}.admin-layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   .ng-invalid[_ngcontent-%COMP%]{border-color:#ff0004}.admin-layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   .ng-valid[_ngcontent-%COMP%]{border-color:#90ee90}.admin-layout[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   .ng-untouched[_ngcontent-%COMP%]{border-color:#add8e6}.admin-layout[_ngcontent-%COMP%]   #partitioned[_ngcontent-%COMP%]{padding-left:15px;letter-spacing:42px;border:0;background-image:linear-gradient(to left,black 70%,rgba(255,255,255,0) 0%);background-position:bottom;background-size:50px 1px;background-repeat:repeat-x;background-position-x:35px;width:220px;min-width:220px}.admin-layout[_ngcontent-%COMP%]   #lblTermCondition[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:#757576;margin:0 5px;cursor:pointer}.admin-layout[_ngcontent-%COMP%]   .panel_dark[_ngcontent-%COMP%]{padding:50px;border-radius:5px;background-color:#2e3342;border:1px solid rgb(65,71,90);color:#bbb;box-shadow:0 0 40px #0006}.admin-layout[_ngcontent-%COMP%]   .panel_dark[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:3px;background-color:#171b25;background-clip:padding-box;border:1px solid #4b5167;color:#bbb}.admin-layout[_ngcontent-%COMP%]   .table-content[_ngcontent-%COMP%]{background-color:#2e3342;border:1px solid #41475a;color:#bbb;box-shadow:0 0 40px #0006}.admin-layout[_ngcontent-%COMP%]   .bg-white[_ngcontent-%COMP%]{background-color:#9d9d9d}.admin-layout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#222633}.admin-layout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:130px!important}.assigning-count-btn[_ngcontent-%COMP%]{width:max-content!important;padding:0 18px}.oculus_btn[_ngcontent-%COMP%]{font-weight:500;color:#fff;width:100px;line-height:1.2;display:block;text-align:center;border-radius:3px;border:none!important;background-image:linear-gradient(to right,#0099a5,#41b787);box-shadow:0 2px 3px #75757580;transition:all .7s ease-in-out}.oculus_btn.disableBtn[_ngcontent-%COMP%]{background-color:#b3e4d0;background-image:none;box-shadow:none;cursor:not-allowed;pointer-events:none}.oculus_btn[_ngcontent-%COMP%]:hover{color:#fff;background-image:linear-gradient(to right,#41b787,#41b787)}.modal-content[_ngcontent-%COMP%]{background-color:#2e3342;border:1px solid rgb(65,71,90);color:#bbb;box-shadow:0 0 40px #0006}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;border-bottom:1px solid rgb(65,71,90)}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:400;font-size:18px;color:#ddd}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{text-align:left}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:3px;background-color:#171b25;background-clip:padding-box;border:1px solid #4b5167;color:#bbb}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:2px}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]{margin-top:-1px;padding:10px;background-color:#171b25;border:1px solid #4b5167}.modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin:0 0 25px;position:relative}.modal-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:15px;line-height:1.4;color:#777;margin:0 0 5px}.modal-content[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{color:#fff;background-color:#6c757d;border-color:#6c757d;width:100px;margin:0 0 0 1.25rem}'],data:{animation:[(0,d.X$)("fade",[(0,d.eR)("void => *",[(0,d.oB)({opacity:0}),(0,d.jt)(700,(0,d.oB)({opacity:1}))])])]}}),n})();function mt(n,r){if(1&n&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function gt(n,r){if(1&n&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Oqu(t.noOfProxy)}}function ht(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"custom-modal",15),e.NdJ("onClose",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.closePlanPreviewPopup(i))}),e.TgZ(1,"app-res-preview-token",16),e.NdJ("generatedSummary",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.generatedResidentialTokenSummary(i))}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("previewTokenData",t.previewTokenData)("isDatacenterPlan",!0)}}function ft(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"custom-modal",17),e.NdJ("onClose",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closeTokenSummaryPopup())}),e._UZ(1,"app-res-token-summary",18),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("residentialOrderSummary",t.residentialOrderSummary)}}let _t=(()=>{class n{constructor(t,o,i,s){this.formBuilder=t,this.homeService=o,this.toastr=i,this.customModalService=s,this.residentialOrderSummary=[],this.datacenterProxiesPlan=[7],this.planDuration=[],this.planQty=[],this.allEmails=[],this.previewTokenData={},this.openPlanPreviewToken=!1,this.openTokenSummary=!1}ngOnInit(){this.initializeForm()}initializeForm(){this.datacenterProxiesAllocationForm=this.formBuilder.group({chooseProxyDuration:new a.p4(null,[a.kI.required]),chooseProxyQty:new a.p4(null,[a.kI.required]),userEmail:new a.p4("",[a.kI.required])}),this.getDatacenterProxies()}getDatacenterProxies(){this.homeService.getResidentialProxies().subscribe(t=>{this.datacenterProxiesPlanResponse=(0,p.filter)(t,o=>this.datacenterProxiesPlan.includes(o.plan_masterId)),this.setProxyDuration()})}setProxyDuration(){const t=[];(0,p.forEach)(this.datacenterProxiesPlanResponse[0].residentialPlans,o=>{t.includes(o.proxy_duration)||t.push(o.proxy_duration)}),this.planDuration=t,this.datacenterProxiesAllocationForm.get("chooseProxyDuration")?.setValue(this.planDuration[0]),this.setProxyQuantity(this.planDuration[0])}changeProxyDuration(t){const o=t.target.value;this.datacenterProxiesAllocationForm.get("chooseProxyDuration")?.setValue(o),this.setProxyQuantity(o)}setProxyQuantity(t){const o=[];(0,p.forEach)(this.datacenterProxiesPlanResponse[0].residentialPlans,i=>{i.proxy_duration===t&&o.push({noOfProxy:i.no_of_proxies,residentailPlansId:i.residentail_plans_id})}),this.planQty=o,this.datacenterProxiesAllocationForm.get("chooseProxyQty")?.setValue(this.planQty[0].noOfProxy),this.planId=this.planQty[0].residentailPlansId}changeProxyQuantity(t){this.planId=this.getPlanId(parseInt(t.target.value,10)),this.datacenterProxiesAllocationForm.get("chooseProxyQty")?.setValue(t.target.value)}getPlanId(t){return this.planQty.find(o=>o.noOfProxy===t)?.residentailPlansId}get planFormControls(){return this.datacenterProxiesAllocationForm.controls}get chooseProxyQty(){return this.datacenterProxiesAllocationForm.get("chooseProxyQty")}get chooseProxyDuration(){return this.datacenterProxiesAllocationForm.get("chooseProxyDuration")}saveDatacenterProxies(){const t=this.planFormControls.userEmail.value?.split(",")||[];this.setValidationForm(t)?(this.allEmails=U(t),this.previewTokenData=this.generatePayload(),this.openPlanPreviewToken=!0,this.customModalService.open("plan-preview-token")):this.showMessage(c.xZ.wrongEmailErrorMessage)}setValidationForm(t){return!t||!t.length||t.every(F.K)}generatePayload(){return{planType:this.homeService.getResidentialPlan(this.datacenterProxiesPlan[0]),email:this.allEmails,dataLimitMegaBytes:"10000000000",noOfProxies:this.chooseProxyQty.value,proxyDuration:this.chooseProxyDuration.value,planId:this.planId}}showMessage(t,o){"success"===o&&this.toastr.success(t,o||c.xZ.success),this.toastr.error(t,o||c.xZ.error)}generatedResidentialTokenSummary(t){this.residentialOrderSummary=t}closePlanPreviewPopup(t){this.openPlanPreviewToken=!1,t&&t.createToken&&(this.openTokenSummary=!0,this.customModalService.open("token-summary"))}closeTokenSummaryPopup(){this.openTokenSummary=!1,this.initializeForm()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(a.QS),e.Y36(J.YD),e.Y36(P._W),e.Y36(k.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-datacenter-token-allocation"]],decls:26,vars:6,consts:[[1,"admin-layout","residential-token-allocation-section","contentPart","layout","mt-5"],[1,"container"],[1,"fs-table-header"],[1,"card","p-4"],[1,"form-row",3,"formGroup"],[1,"form-group","col-md-4"],["for","inputState"],["id","inputState","formControlName","chooseProxyDuration",1,"form-control",3,"change"],[4,"ngFor","ngForOf"],["id","inputState","formControlName","chooseProxyQty",1,"form-control",3,"change"],["type","text","rows","3","cols","6","placeholder","Enter valid emails","formControlName","userEmail",1,"form-control"],[1,"d-flex","flex-row-reverse"],[1,"border","oculus_btn",3,"click"],["class","admin-layout","id","plan-preview-token",3,"onClose",4,"ngIf"],["id","token-summary","class","admin-layout","theme","dark",3,"onClose",4,"ngIf"],["id","plan-preview-token",1,"admin-layout",3,"onClose"],[3,"previewTokenData","isDatacenterPlan","generatedSummary"],["id","token-summary","theme","dark",1,"admin-layout",3,"onClose"],[1,"scroll",3,"residentialOrderSummary"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Datacenter Proxies Allocation"),e.qZA(),e._UZ(4,"hr"),e.TgZ(5,"form",3)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Choose Proxy Duration"),e.qZA(),e.TgZ(10,"select",7),e.NdJ("change",function(s){return o.changeProxyDuration(s)}),e.YNc(11,mt,2,1,"option",8),e.qZA()(),e.TgZ(12,"div",5)(13,"label",6),e._uU(14,"Choose Proxy Qty"),e.qZA(),e.TgZ(15,"select",9),e.NdJ("change",function(s){return o.changeProxyQuantity(s)}),e.YNc(16,gt,2,1,"option",8),e.qZA()(),e.TgZ(17,"div",5)(18,"label",6),e._uU(19,"Enter User Emails (Separated By Comma)"),e.qZA(),e._UZ(20,"textarea",10),e.qZA()(),e.TgZ(21,"div",11)(22,"button",12),e.NdJ("click",function(){return o.saveDatacenterProxies()}),e._uU(23," Save "),e.qZA()()()()(),e.YNc(24,ht,2,2,"custom-modal",13),e.YNc(25,ft,2,1,"custom-modal",14)),2&t&&(e.Q6J("@fade",void 0),e.xp6(6),e.Q6J("formGroup",o.datacenterProxiesAllocationForm),e.xp6(5),e.Q6J("ngForOf",o.planDuration),e.xp6(5),e.Q6J("ngForOf",o.planQty),e.xp6(8),e.Q6J("ngIf",o.openPlanPreviewToken),e.xp6(1),e.Q6J("ngIf",o.openTokenSummary))},dependencies:[m.sg,m.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,a.F,W,ee,Z.R],styles:[".admin-layout[_ngcontent-%COMP%]   .panel_dark[_ngcontent-%COMP%]{padding:50px!important;border-radius:5px!important;background-color:#2e3342!important;border:1px solid rgb(65,71,90)!important;color:#bbb!important;box-shadow:0 0 40px #0006!important}.admin-layout[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:3px!important;background-color:#f8f8fb!important;background-clip:padding-box!important;border:1px solid #4b5167!important;color:#4b4f55!important}.admin-layout[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:none!important}.admin-layout[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#41b787!important;transition:all 0s!important}.admin-layout[_ngcontent-%COMP%]   .red[_ngcontent-%COMP%]{color:red}.admin-layout[_ngcontent-%COMP%]   .scroll[_ngcontent-%COMP%]{overflow-y:hidden;overflow-x:scroll}.admin-layout[_ngcontent-%COMP%]   .btn-disabled[_ngcontent-%COMP%]{background:#9d9d9d!important;cursor:auto!important}.admin-layout[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#222633}.admin-layout[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:40%!important}.admin-layout[_ngcontent-%COMP%]   .plan-select-type[_ngcontent-%COMP%]{min-width:100px}.admin-layout[_ngcontent-%COMP%]   .disabled-control[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}"],data:{animation:[(0,d.X$)("fade",[(0,d.eR)("void => *",[(0,d.oB)({opacity:0}),(0,d.jt)(700,(0,d.oB)({opacity:1}))])])]}}),n})();var M=l(9716);const bt=w.Bz.forChild([{path:"",redirectTo:"token_allocation",pathMatch:"full",data:{role:"admin"}},{path:"residential_token_allocation",component:et,canActivate:[y.a,M.u],data:{role:"admin",title:"Residential Proxies Allocation"}},{path:"token_allocation",component:ut,canActivate:[y.a,M.u],data:{role:"admin",title:"ISP Proxies Allocation"}},{path:"datacenter_proxies_allocation",component:_t,canActivate:[y.a,M.u],data:{role:"admin",title:"Datacenter Proxies Allocation"}},{path:"edit_plan_content",component:Ye,canActivate:[y.a,M.u],data:{role:"admin",title:"Manage Proxy Plan"}},{path:"coupon_manage",component:Ie,canActivate:[y.a,M.u],data:{role:"admin",title:"Coupon Manage"}},{path:"osi_affiliate",component:ue,canActivate:[y.a,M.u],data:{role:"admin",title:"OSI affiliate"}}]);var yt=l(9496),vt=l(6476),te=l(7763);let xt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.ez,bt,a.UX,a.u5,te.v,yt.m,te.v,vt.d]}),n})()},1179:(oe,A,l)=>{l.d(A,{K:()=>y,o:()=>w});let m=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,a=/^(([^<>()[\]\\.,;:\s@I"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;const w=e=>e.value?(e.value&&d(e.value)&&(m=a),e.value&&!m.test(e.value)?{errors:{message:"Please enter valid email"}}:null):{errors:!0},y=e=>{const p=e.replace(/(\r\n|\n|\r| )/gm,"");return d(p)&&(m=a),m.test(p)},d=e=>"string"==typeof e&&e.includes("@brightdata.com")}}]);