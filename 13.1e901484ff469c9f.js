"use strict";(self.webpackChunkoculus_web=self.webpackChunkoculus_web||[]).push([[13],{7013:(U,d,a)=>{a.d(d,{m:()=>I});var t=a(4650),i=a(4608),r=a(2587),l=a(1338),u=a(5140),p=a(9697),_=a(5628),h=a(7185),g=a(1507),y=a(3305),m=a(6895);function P(s,c){1&s&&(t.TgZ(0,"div",8)(1,"h5",9),t._uU(2,"Payment Status"),t.qZA()())}function x(s,c){if(1&s&&(t.ynx(0),t.TgZ(1,"h1")(2,"div"),t._UZ(3,"img",10),t.qZA(),t.TgZ(4,"div",11),t._uU(5),t.qZA()(),t.BQk()),2&s){const n=t.oxw();t.xp6(5),t.hij(" ",n.isAddPaymentMethod?"Please wait, we are processing your payment method.":"Please wait, we are processing your transaction."," ")}}function f(s,c){if(1&s&&(t.ynx(0),t.TgZ(1,"h1"),t._UZ(2,"img",12)(3,"div",13),t.qZA(),t.BQk()),2&s){const n=t.oxw();t.xp6(2),t.MGl("src","../../../assets/images/",n.icon,"",t.LSH),t.xp6(1),t.Q6J("innerHtml",n.statusText,t.oJD)}}function O(s,c){if(1&s){const n=t.EpF();t.ynx(0),t._uU(1," Congratulations, your payment is successful! You can now start using your plan."),t._UZ(2,"br"),t._uU(3,"You can click "),t.TgZ(4,"a",17),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.handleRoutingAfterSuccess(o.residentialProxyType))}),t._uU(5,"here "),t.qZA(),t._uU(6,"to check your plan details. "),t.BQk()}}function E(s,c){if(1&s){const n=t.EpF();t._uU(0," Congratulations, your payment method is added successfully!"),t._UZ(1,"br"),t._uU(2,"You can click "),t.TgZ(3,"a",17),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.handleRoutingAfterSuccess(o.residentialProxyType,o.isAddPaymentMethod))}),t._uU(4,"here "),t.qZA(),t._uU(5,"to check your payment method. ")}}function C(s,c){if(1&s){const n=t.EpF();t.ynx(0),t._uU(1," Your payment was successful but unfortunately we were not able to verify your billing details (name on your credit card or billing address) so we have granted you a performance plan. Please reach out to us via "),t.TgZ(2,"a",18),t._uU(3,"discord"),t.qZA(),t._uU(4," or email at "),t.TgZ(5,"a",19),t._uU(6,"support@oculusproxies.com"),t.qZA(),t._uU(7," for further support. Click"),t.TgZ(8,"a",17),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.handleRoutingAfterSuccess(o.residentialProxyEnum.OCULUS_NETWORK_PERFORMANCE))}),t._uU(9," here "),t.qZA(),t._uU(10,"to check your order details. "),t.BQk()}}function T(s,c){if(1&s&&(t.ynx(0),t.TgZ(1,"h1"),t._UZ(2,"img",12),t.TgZ(3,"div",14),t.YNc(4,O,7,0,"ng-container",15),t.YNc(5,E,6,0,"ng-template",null,16,t.W1O),t.YNc(7,C,11,0,"ng-container",6),t.qZA()(),t.BQk()),2&s){const n=t.MAs(6),e=t.oxw();t.xp6(2),t.MGl("src","../../../assets/images/",e.icon,"",t.LSH),t.xp6(2),t.Q6J("ngIf",e.status===e.paymentStatus.COMPLETED&&!e.isAddPaymentMethod)("ngIfElse",n),t.xp6(3),t.Q6J("ngIf",e.status===e.paymentStatus.INVALID_PAYMENT_DETAIL)}}function S(s,c){if(1&s&&(t.ynx(0),t.TgZ(1,"h1"),t._UZ(2,"img",20),t.TgZ(3,"div",21),t._uU(4),t.qZA()(),t.BQk()),2&s){const n=t.oxw();t.xp6(4),t.hij(" ",null!==n.errorMessage?n.errorMessage:"Your payment has failed. Please try again."," ")}}function M(s,c){if(1&s){const n=t.EpF();t.TgZ(0,"div",22)(1,"button",23),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.closeModel())}),t._uU(2," Close "),t.qZA()()}if(2&s){const n=t.oxw();t.xp6(1),t.ekj("btn-disabled",n.isLoadingStatus||"initiated"===n.status)}}let I=(()=>{class s{constructor(n,e,o,v,D,A){this.router=n,this.authenticationService=e,this.toastrService=o,this.orderService=v,this.customModalService=D,this._dataLayerService=A,this._vs=(0,t.f3M)(u.P),this.sessionId="",this.stripePaymentId="",this.isExtendPlan=!1,this.typeOfProxy=i._W.BASIC,this.subscriptionId="",this.contentOnly=!1,this.finalPrice=0,this.residentialProxyEnum=i.sz,this.isVersionV1Supported=!1,this.residentialProxyType=i.sz.OCULUS_NETWORK_EXTREME,this.closeDialog=new t.vpe,this.apiResponse=new t.vpe,this.isAddPaymentMethod=!1,this.loggedPurchase=!1,this.isLoadingStatus=!1,this.paymentStatus=r.bG,this.status=r.bG.INITIATED,this.statusText="",this.icon="success-icon.png"}ngOnInit(){this.loggedPurchase=!1,console.log("this.sessionId,",this.sessionId),console.log("residential proxy",this.residentialProxyType,this.subscriptionId,this.sessionId,this.finalPrice,this.extendPlanData),this.sessionId?(this.getTransactionStatus(this.sessionId),this.interval=setInterval(()=>{this.getTransactionStatus(this.sessionId)},3e3)):(this.toastrService.error(l.xZ.paymentSessionIdMissingErrorMessage,l.xZ.error),this.contentOnly?this.router.navigate([this._vs.homeUrl]):this.closeDialog.emit(!0))}getTransactionStatus(n){this.isLoadingStatus=!0,n?this.orderService.getTransactionStatus(n,this.isVersionV1Supported).subscribe(e=>{e&&e.status?(this.isLoadingStatus=!1,this.status=e.status.toLowerCase(),this.errorMessage=e.errorMessage,"initiated"!==this.status&&clearInterval(this.interval),e?.orderAmount&&(this.finalPrice=e.orderAmount),this.setOrderStatus(this.status)):(this.isLoadingStatus=!1,this.setOrderStatus(this.paymentStatus.INVALID_REQUEST))},e=>{console.log("any error",e),clearInterval(this.interval),this.toastrService.error("Error while proccessing payment","Payment error")}):this.router.navigate([this._vs.homeUrl])}setOrderStatus(n){switch(console.log("status",n),n!==this.paymentStatus.INITIATED&&this.apiResponse.emit(!0),n){case this.paymentStatus.COMPLETED:console.log("[Trying log PURCHASE]"),this.loggedPurchase||(this._logTrackPurchaseEvent(),this.loggedPurchase=!0),this.icon="success-icon.png",this.statusText="",console.log("event tracking started for residential","isExtendPlan: ",this.isExtendPlan,"\ntypeOfProxy: ",this.typeOfProxy,"\nsubscriptionId: ",this.subscriptionId,"\nsessionId: ",this.sessionId,"\nextendData: ",this.extendPlanData);break;case this.paymentStatus.UNCOMPLETED:this.icon="failed-icon.jpg",this.statusText="Your payment is timeout";break;case this.paymentStatus.INVALID_REQUEST:this.icon="failed-icon.jpg",this.statusText="Your payment link is expired or invalid";break;case this.paymentStatus.INVALID_PAYMENT_DETAIL:this.icon="warning-icon.png",this.statusText="";break;default:this.icon="",this.statusText=""}}_logTrackPurchaseEvent(){if(!this.proxyDetails)return;const n={transaction_id:(new Date).toISOString(),value:Number(this.finalPrice).toFixed(2),currency:"USD",coupon:this.appliedCouponCode||"",item_name:(this.proxyDetails.proxyLocation?.locationDisplayName||this.residentialProxyType||"")+(this._vs.isV2OrV3?"-V2":""),item_id:this.proxyDetails.id||this.proxyDetails.residentail_plans_id||"",price:Number(this.finalPrice).toFixed(2),item_category:("basic"===this.typeOfProxy?`ISP::${this.proxyDetails.proxyLocation?.locationDisplayName||""}`:`Residential::${this.residentialProxyType}`)+(this._vs.isV2OrV3?"-V2":""),quantity:"1",items:[{item_name:(this.proxyDetails.proxyLocation?.locationDisplayName||this.residentialProxyType||"")+(this._vs.isV2OrV3?"-V2":""),item_id:this.proxyDetails.id||this.proxyDetails.residentail_plans_id||"",price:Number(this.finalPrice).toFixed(2),item_category:("basic"===this.typeOfProxy?`ISP::${this.proxyDetails.proxyLocation?.locationDisplayName||""}`:`Residential::${this.residentialProxyType}`)+(this._vs.isV2OrV3?"-V2":""),quantity:"1"}]};console.log("[PURCHASE] track events in ga4....",n),this._vs.isV2OrV3&&this.orderService.setGTMEvents([{order_amount:`${Number(this.finalPrice).toFixed(2)}`,payment_type:this.isExtendPlan?"Extend":"One Time",plan_type:this._getPlanType(this.proxyDetails.id||this.proxyDetails.residentail_plans_id||""),oc_token:this.isExtendPlan?"e-token":"ot-token",isV2:this._vs.isV2OrV3}]).subscribe(),this._dataLayerService.logPurchaseItem(window.location.href,n),this._dataLayerService.trackOSIAffiliate(`${Number(this.finalPrice).toFixed(2)}`,btoa(this.sessionId))}_getPlanType(n){const e=Number(n);if(n)switch(!0){case 8===e||e>=51&&e<=55:return r.Le.DEDICATED_DC;case 9===e||e>=56&&e<=59:return r.Le.SHARED_DC;case 10===e||e>=60&&e<=63:return r.Le.ISP_PROXY}return this.getResidentialFragment(this.residentialProxyType)}handleRoutingAfterSuccess(n,e){this.isExtendPlan&&!this.isVersionV1Supported?this.closeModel():e?this.router.navigate(["/paymentMethods"]):this._vs.isV2OrV3?(this.closeModel(),this.residentialProxyType===i.sz.OCULUS_ISP_PROXIES?this.router.navigate([this._vs.getOrderURL("ispProxy")]):this.router.navigate([this._vs.getOrderURL("datacenterProxy")],{fragment:this.getResidentialFragment(n)})):(this.closeModel(),this.typeOfProxy===i._W.PREMIUM?this.residentialProxyType===i.sz.OCULUS_SHARED_DATA_CENTER?this.router.navigate([this._vs.getOrderURL("dataCenterProxy")]):this.router.navigate([this._vs.getOrderURL("residentialProxy")],{fragment:this.getResidentialFragment(n)}):this.router.navigate([this._vs.getOrderURL("ispProxy")]))}getResidentialFragment(n){switch(n){case i.sz.OCULUS_NETWORK_EXTREME:return r.Le.OCULUS_NETWORK_EXTREME;case i.sz.OCULUS_NETWORK_PERFORMANCE:return r.Le.PERFORMANCE;case i.sz.OCULUS_PRIVATE_RESERVE:return r.Le.OCULUS_PRIVATE_RESERVE;case i.sz.OCULUS_NETWORK_RETAIL:return r.Le.OCULUS_NETWORK_RETAIL;case i.sz.OCULUS_SHARED_DC:return r.Le.SHARED_DC;case i.sz.OCULUS_DEDICATED_DC:return r.Le.DEDICATED_DC;default:return r.Le.PERFORMANCE}}closeModel(){this.extendPlanData&&this.customModalService.close("extend-plan"),this.typeOfProxy===i._W.BASIC&&this.orderService.isSuccessfullyRenewIspOrder$.next(!0),this.closeDialog.emit(!0)}ngOnDestroy(){this.interval&&clearInterval(this.interval)}}return s.\u0275fac=function(n){return new(n||s)(t.Y36(p.F0),t.Y36(_.$h),t.Y36(h._W),t.Y36(_.px),t.Y36(g.k),t.Y36(y.n))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-success-payment"]],inputs:{sessionId:"sessionId",stripePaymentId:"stripePaymentId",isExtendPlan:"isExtendPlan",typeOfProxy:"typeOfProxy",subscriptionId:"subscriptionId",extendPlanData:"extendPlanData",contentOnly:"contentOnly",finalPrice:"finalPrice",isVersionV1Supported:"isVersionV1Supported",residentialProxyType:"residentialProxyType",isAddPaymentMethod:"isAddPaymentMethod",proxyDetails:"proxyDetails",appliedCouponCode:"appliedCouponCode"},outputs:{closeDialog:"closeDialog",apiResponse:"apiResponse"},decls:16,vars:18,consts:[[1,"payment-history","d-table"],["class","modal-header",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"contact-part"],[1,"title-section"],[4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"modal-header"],[1,"modal-title"],["src","assets/images/ajax-loader_1.svg"],[1,"loading-section",2,"text-transform","initial"],[1,"status-icon",3,"src"],[2,"text-transform","none",3,"innerHtml"],[2,"text-transform","none"],[4,"ngIf","ngIfElse"],["other",""],[1,"link",3,"click"],["href","https://discord.com/invite/eNew2hGGru","target","_blank"],["href","mailto::support@oculusproxies.com"],["src","../../../assets/images/failed-icon.jpg",1,"status-icon"],[1,"text-transform-none"],[1,"modal-footer"],["id","closeBtn","type","button",1,"btn","btn-light",3,"click"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div")(2,"div"),t.YNc(3,P,3,0,"div",1),t.ynx(4),t.TgZ(5,"div")(6,"div")(7,"div",2)(8,"div",3)(9,"div",4)(10,"div",5),t.YNc(11,x,6,1,"ng-container",6),t.YNc(12,f,4,2,"ng-container",6),t.YNc(13,T,8,4,"ng-container",6),t.YNc(14,S,5,1,"ng-container",6),t.qZA()()()()()(),t.BQk(),t.YNc(15,M,3,2,"div",7),t.qZA()()()),2&n&&(t.xp6(1),t.Tol(e.contentOnly?"":"modal-dialog"),t.xp6(1),t.Tol(e.contentOnly?"":"modal-content"),t.xp6(1),t.Q6J("ngIf",!e.contentOnly),t.xp6(2),t.Tol(e.contentOnly?"":"modal-body"),t.xp6(1),t.Gre("container ",e.contentOnly?"center-content":"",""),t.xp6(5),t.Q6J("ngIf",e.isLoadingStatus||e.status===e.paymentStatus.INITIATED),t.xp6(1),t.Q6J("ngIf",!e.isLoadingStatus&&""!==e.statusText&&e.status!==e.paymentStatus.INITIATED),t.xp6(1),t.Q6J("ngIf",!e.isLoadingStatus&&""===e.statusText&&e.status!==e.paymentStatus.INITIATED&&e.status!==e.paymentStatus.FAILED),t.xp6(1),t.Q6J("ngIf",!e.isLoadingStatus&&""===e.statusText&&e.status!==e.paymentStatus.INITIATED&&e.status===e.paymentStatus.FAILED),t.xp6(1),t.Q6J("ngIf",!e.contentOnly))},dependencies:[m.O5],styles:[".payment-history[_ngcontent-%COMP%]{width:100%}.payment-history[_ngcontent-%COMP%]   .center-content[_ngcontent-%COMP%]{margin-top:16rem;margin-bottom:16rem}.payment-history[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;border-bottom:1px solid rgb(65,71,90)}.payment-history[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:400;font-size:18px;color:#ddd}.payment-history[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{text-align:left}.payment-history[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{margin:5rem}.payment-history[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:100!important}.payment-history[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .loading-section[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:0 auto;align-items:center;text-transform:initial}.payment-history[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background-color:#2e3342;border:1px solid rgb(65,71,90);color:#bbb;box-shadow:0 0 40px #0006}.payment-history[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-top:1px solid rgb(65,71,90)}.payment-history[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .oculus_btn[_ngcontent-%COMP%]{width:auto;height:39px;padding:9 15px;font-weight:400;font-size:16px}.payment-history[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .payment-history[_ngcontent-%COMP%]   a.btn[_ngcontent-%COMP%]{color:#62fcc1;text-decoration:none;transition:.4s}.payment-history[_ngcontent-%COMP%]   .btn-disabled[_ngcontent-%COMP%]{background:#9d9d9d!important;cursor:auto!important}.payment-history[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:5px;font-size:15px;line-height:1.2;font-weight:500;letter-spacing:.1px;text-align:center;padding:10px;box-shadow:0 2px 4px #00000026;transition:.4s}.payment-history[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{height:auto!important;width:100px!important;padding-bottom:48px!important}.payment-history[_ngcontent-%COMP%]   .text-transform-none[_ngcontent-%COMP%]{text-transform:none}"]}),s})()}}]);